const constant_data=Object.freeze({MAX_PLAYERS:10,MIN_USERNAME_LENGTH:2,MAX_USERNAME_LENGTH:12,MIN_PASSWORD_LENGTH:4,MAX_PASSWORD_LENGTH:60,MAX_MESSAGE_LENGTH:40,MAX_ROOM_LENGTH:16,MIN_ROOMNAME_LENGTH:2,MIN_ROUNDS:2,MAX_ROUNDS:10,FORCE_WORD_TIMER:20,END_TURN_TIME:6,BTL_VOTE_DURATION:15,DRAW_TIME_VALUES:[30,60,80,160],ROUNDS_VALUES:[2,3,4,5,6,7,8,9,10],LANG_VALUES:["en","fr"],MAP_SIZE:3e3,VALUE_RANGES:{},DEFAULT_Values:{ROUNDS:8,DRAWTIME:80,LANG_CHECK:!0,LANG:"en"},MSG_TYPES:{LOGIN:"log",SPAM_ALERT:"spal",USER_DATA:"ud",ALREADY_LOGGED:"alog",DISCONNECTED:"disc",REGISTER:"reg",BROWSER_UPDATE:"rbu",ROOM_DOES_NOT_EXIST:"rdne",ERROR:"err",CREATE_ROOM:"crro",JOIN_ROOM:"joro",UPDATE_ANIME_LIST:"upali",ADD_PLAYER:"adpl",REMOVE_PLAYER:"repl",REMOVE_PLAYERS:"repls",NEW_OWNER:"neow",LEAVE_ROOM:"Lero",START_GAME:"stga",UPDATE_ROOM:"upro",RECONNECT_ROOM:"rero",PLAYER_RECONNECTED:"plre",PLAYER_DISCONNECTED:"plds",MESSAGE:"msg",NEW_DRAWER:"drw",NEW_ROUND:"newrund",P_DC:"pdc",GUESS:"guess",P_GUESSED_T:"pguet",WORDS_CHOICE:"worchoi",START_DRAW:"stdr",DRAW_CLEAR:"drcl",START_DRAW_D:"stdrd",END_TURN:"entu",END_GAME:"enga",BACK_TO_LOBBY:"batol",BACK_TO_LOBBY_VOTE:"batolv",END_BTL_VOTE:"ebtlv",DRAW:"draw",GET_ANIME_NAMES:"geann"},RESULT:{SUCCESS:"success",FAILURE:"failure"},ANIMELISTS:{MAL:0,ANILIST:1}}),roomStates=Object.freeze({STARTING_GAME:0,PICKING_WORD:1,DRAWING:2,ENDING_TURN:3,ENDING_GAME:4});try{module.exports.constant_data=constant_data,module.exports.roomStates=roomStates,module.exports.RoomData=RoomData}catch(t){}!function(e){"function"==typeof define&&define.amd?define(["jquery"],e):e(jQuery)}(function(S){function O(a,t,e){return[parseFloat(a[0])*(f.test(a[0])?t/100:1),parseFloat(a[1])*(f.test(a[1])?e/100:1)]}function T(a,t){return parseInt(S.css(a,t),10)||0}S.ui=S.ui||{},S.ui.version="1.12.1";var d,c=0,p=Array.prototype.slice;S.cleanData=(d=S.cleanData,function(a){for(var t,o,n=0;null!=(o=a[n]);n++)try{(t=S._data(o,"events"))&&t.remove&&S(o).triggerHandler("remove")}catch(e){}d(a)}),S.widget=function(d,c,p){var m,u,g,_={},a=d.split(".")[0],l=a+"-"+(d=d.split(".")[1]);return p||(p=c,c=S.Widget),S.isArray(p)&&(p=S.extend.apply(null,[{}].concat(p))),S.expr[":"][l.toLowerCase()]=function(e){return!!S.data(e,l)},S[a]=S[a]||{},m=S[a][d],u=S[a][d]=function(a,t){return this._createWidget?void(arguments.length&&this._createWidget(a,t)):new u(a,t)},S.extend(u,m,{version:p.version,_proto:S.extend({},p),_childConstructors:[]}),(g=new c).options=S.widget.extend({},g.options),S.each(p,function(a,r){function s(){return c.prototype[a].apply(this,arguments)}function n(e){return c.prototype[a].apply(this,e)}_[a]=S.isFunction(r)?function(){var a,o=this._super,e=this._superApply;return this._super=s,this._superApply=n,a=r.apply(this,arguments),this._super=o,this._superApply=e,a}:r}),u.prototype=S.widget.extend(g,{widgetEventPrefix:m&&g.widgetEventPrefix||d},_,{constructor:u,namespace:a,widgetName:d,widgetFullName:l}),m?(S.each(m._childConstructors,function(a,t){var e=t.prototype;S.widget(e.namespace+"."+e.widgetName,u,t._proto)}),delete m._childConstructors):c._childConstructors.push(u),S.widget.bridge(d,u),u},S.widget.extend=function(a){for(var t,r,l=p.call(arguments,1),s=0,d=l.length;s<d;s++)for(t in l[s])r=l[s][t],l[s].hasOwnProperty(t)&&void 0!==r&&(S.isPlainObject(r)?a[t]=S.isPlainObject(a[t])?S.widget.extend({},a[t],r):S.widget.extend({},r):a[t]=r);return a},S.widget.bridge=function(r,o){var l=o.prototype.widgetFullName||r;S.fn[r]=function(a){var e="string"==typeof a,d=p.call(arguments,1),s=this;return e?this.length||"instance"!==a?this.each(function(){var o,n=S.data(this,l);return"instance"===a?(s=n,!1):n?S.isFunction(n[a])&&"_"!==a.charAt(0)?(o=n[a].apply(n,d))!==n&&void 0!==o?(s=o&&o.jquery?s.pushStack(o.get()):o,!1):void 0:S.error("no such method '"+a+"' for "+r+" widget instance"):S.error("cannot call methods on "+r+" prior to initialization; attempted to call method '"+a+"'")}):s=void 0:(d.length&&(a=S.widget.extend.apply(null,[a].concat(d))),this.each(function(){var e=S.data(this,l);e?(e.option(a||{}),e._init&&e._init()):S.data(this,l,new o(a,this))})),s}},S.Widget=function(){},S.Widget._childConstructors=[],S.Widget.prototype={widgetName:"widget",widgetEventPrefix:"",defaultElement:"<div>",options:{classes:{},disabled:!1,create:null},_createWidget:function(a,o){o=S(o||this.defaultElement||this)[0],this.element=S(o),this.uuid=c++,this.eventNamespace="."+this.widgetName+this.uuid,this.bindings=S(),this.hoverable=S(),this.focusable=S(),this.classesElementLookup={},o!==this&&(S.data(o,this.widgetFullName,this),this._on(!0,this.element,{remove:function(e){e.target===o&&this.destroy()}}),this.document=S(o.style?o.ownerDocument:o.document||o),this.window=S(this.document[0].defaultView||this.document[0].parentWindow)),this.options=S.widget.extend({},this.options,this._getCreateOptions(),a),this._create(),this.options.disabled&&this._setOptionDisabled(this.options.disabled),this._trigger("create",null,this._getCreateEventData()),this._init()},_getCreateOptions:function(){return{}},_getCreateEventData:S.noop,_create:S.noop,_init:S.noop,destroy:function(){var a=this;this._destroy(),S.each(this.classesElementLookup,function(o,t){a._removeClass(t,o)}),this.element.off(this.eventNamespace).removeData(this.widgetFullName),this.widget().off(this.eventNamespace).removeAttr("aria-disabled"),this.bindings.off(this.eventNamespace)},_destroy:S.noop,widget:function(){return this.element},option:function(a,r){var e,l,d,c=a;if(0===arguments.length)return S.widget.extend({},this.options);if("string"==typeof a)if(c={},a=(e=a.split(".")).shift(),e.length){for(l=c[a]=S.widget.extend({},this.options[a]),d=0;d<e.length-1;d++)l[e[d]]=l[e[d]]||{},l=l[e[d]];if(a=e.pop(),1===arguments.length)return void 0===l[a]?null:l[a];l[a]=r}else{if(1===arguments.length)return void 0===this.options[a]?null:this.options[a];c[a]=r}return this._setOptions(c),this},_setOptions:function(a){for(var t in a)this._setOption(t,a[t]);return this},_setOption:function(a,t){return"classes"===a&&this._setOptionClasses(t),this.options[a]=t,"disabled"===a&&this._setOptionDisabled(t),this},_setOptionClasses:function(a){var t,o,n;for(t in a)n=this.classesElementLookup[t],a[t]!==this.options.classes[t]&&n&&n.length&&(o=S(n.get()),this._removeClass(n,t),o.addClass(this._classes({element:o,keys:t,classes:a,add:!0})))},_setOptionDisabled:function(e){this._toggleClass(this.widget(),this.widgetFullName+"-disabled",null,!!e),e&&(this._removeClass(this.hoverable,null,"ui-state-hover"),this._removeClass(this.focusable,null,"ui-state-focus"))},enable:function(){return this._setOptions({disabled:!1})},disable:function(){return this._setOptions({disabled:!0})},_classes:function(r){function e(a,t){for(var e,n=0;n<a.length;n++)e=o.classesElementLookup[a[n]]||S(),e=r.add?S(S.unique(e.get().concat(r.element.get()))):S(e.not(r.element).get()),o.classesElementLookup[a[n]]=e,l.push(a[n]),t&&r.classes[a[n]]&&l.push(r.classes[a[n]])}var l=[],o=this;return r=S.extend({element:this.element,classes:this.options.classes||{}},r),this._on(r.element,{remove:"_untrackClassesElement"}),r.keys&&e(r.keys.match(/\S+/g)||[],!0),r.extra&&e(r.extra.match(/\S+/g)||[]),l.join(" ")},_untrackClassesElement:function(a){var o=this;S.each(o.classesElementLookup,function(n,t){-1!==S.inArray(a.target,t)&&(o.classesElementLookup[n]=S(t.not(a.target).get()))})},_removeClass:function(a,t,e){return this._toggleClass(a,t,e,!1)},_addClass:function(a,t,e){return this._toggleClass(a,t,e,!0)},_toggleClass:function(a,o,e,r){r="boolean"==typeof r?r:e;var i="string"==typeof a||null===a,a={extra:i?o:e,keys:i?a:o,element:i?this.element:a,add:r};return a.element.toggleClass(this._classes(a),r),this},_on:function(s,r,e){var d,c=this;"boolean"!=typeof s&&(e=r,r=s,s=!1),e?(r=d=S(r),this.bindings=this.bindings.add(r)):(e=r,r=this.element,d=this.widget()),S.each(e,function(a,o){function e(){if(s||!0!==c.options.disabled&&!S(this).hasClass("ui-state-disabled"))return("string"==typeof o?c[o]:o).apply(c,arguments)}"string"!=typeof o&&(e.guid=o.guid=o.guid||e.guid||S.guid++);var n=a.match(/^([\w:-]*)\s*(.*)$/),a=n[1]+c.eventNamespace,n=n[2];n?d.on(a,n,e):r.on(a,e)})},_off:function(a,t){t=(t||"").split(" ").join(this.eventNamespace+" ")+this.eventNamespace,a.off(t).off(t),this.bindings=S(this.bindings.not(a).get()),this.focusable=S(this.focusable.not(a).get()),this.hoverable=S(this.hoverable.not(a).get())},_delay:function(a,t){var e=this;return setTimeout(function(){return("string"==typeof a?e[a]:a).apply(e,arguments)},t||0)},_hoverable:function(e){this.hoverable=this.hoverable.add(e),this._on(e,{mouseenter:function(e){this._addClass(S(e.currentTarget),null,"ui-state-hover")},mouseleave:function(e){this._removeClass(S(e.currentTarget),null,"ui-state-hover")}})},_focusable:function(e){this.focusable=this.focusable.add(e),this._on(e,{focusin:function(e){this._addClass(S(e.currentTarget),null,"ui-state-focus")},focusout:function(e){this._removeClass(S(e.currentTarget),null,"ui-state-focus")}})},_trigger:function(a,t,r){var l,d,c=this.options[a];if(r=r||{},(t=S.Event(t)).type=(a===this.widgetEventPrefix?a:this.widgetEventPrefix+a).toLowerCase(),t.target=this.element[0],d=t.originalEvent)for(l in d)l in t||(t[l]=d[l]);return this.element.trigger(t,r),!(S.isFunction(c)&&!1===c.apply(this.element[0],[t].concat(r))||t.isDefaultPrevented())}},S.each({show:"fadeIn",hide:"fadeOut"},function(r,o){S.Widget.prototype["_"+r]=function(a,e,l){var i;"string"==typeof e&&(e={effect:e});var d=e?!0!==e&&"number"!=typeof e&&e.effect||o:r;"number"==typeof(e=e||{})&&(e={duration:e}),i=!S.isEmptyObject(e),e.complete=l,e.delay&&a.delay(e.delay),i&&S.effects&&S.effects.effect[d]?a[r](e):d!==r&&a[d]?a[d](e.duration,e.easing,l):a.queue(function(e){S(this)[r](),l&&l.call(a[0]),e()})}});var l,_,v,m,g,b,y,f,M;S.widget,_=Math.max,v=Math.abs,m=/left|center|right/,g=/top|center|bottom/,b=/[\+\-]\d+(\.[\d]+)?%?/,y=/^\w+/,f=/%$/,M=S.fn.position,S.position={scrollbarWidth:function(){if(void 0!==l)return l;var a,o=S("<div style='display:block;position:absolute;width:50px;height:50px;overflow:hidden;'><div style='height:100px;width:auto;'></div></div>"),e=o.children()[0];return S("body").append(o),a=e.offsetWidth,o.css("overflow","scroll"),a===(e=e.offsetWidth)&&(e=o[0].clientWidth),o.remove(),l=a-e},getScrollInfo:function(a){var t=a.isWindow||a.isDocument?"":a.element.css("overflow-x"),o=a.isWindow||a.isDocument?"":a.element.css("overflow-y"),t="scroll"===t||"auto"===t&&a.width<a.element[0].scrollWidth;return{width:"scroll"===o||"auto"===o&&a.height<a.element[0].scrollHeight?S.position.scrollbarWidth():0,height:t?S.position.scrollbarWidth():0}},getWithinInfo:function(a){var t=S(a||window),e=S.isWindow(t[0]),o=!!t[0]&&9===t[0].nodeType;return{element:t,isWindow:e,isDocument:o,offset:e||o?{left:0,top:0}:S(a).offset(),scrollLeft:t.scrollLeft(),scrollTop:t.scrollTop(),width:t.outerWidth(),height:t.outerHeight()}}},S.fn.position=function(E){if(!E||!E.of)return M.apply(this,arguments);E=S.extend({},E);var s,P,R,h,C,a,A=S(E.of),D=S.position.getWithinInfo(E.within),G=S.position.getScrollInfo(D),Y=(E.collision||"flip").split(" "),N={},o=9===(a=(o=A)[0]).nodeType?{width:o.width(),height:o.height(),offset:{top:0,left:0}}:S.isWindow(a)?{width:o.width(),height:o.height(),offset:{top:o.scrollTop(),left:o.scrollLeft()}}:a.preventDefault?{width:0,height:0,offset:{top:a.pageY,left:a.pageX}}:{width:o.outerWidth(),height:o.outerHeight(),offset:o.offset()};return A[0].preventDefault&&(E.at="left top"),P=o.width,R=o.height,h=o.offset,C=S.extend({},h),S.each(["my","at"],function(){var a,o,n=(E[this]||"").split(" ");1===n.length&&(n=m.test(n[0])?n.concat(["center"]):g.test(n[0])?["center"].concat(n):["center","center"]),n[0]=m.test(n[0])?n[0]:"center",n[1]=g.test(n[1])?n[1]:"center",a=b.exec(n[0]),o=b.exec(n[1]),N[this]=[a?a[0]:0,o?o[0]:0],E[this]=[y.exec(n[0])[0],y.exec(n[1])[0]]}),1===Y.length&&(Y[1]=Y[0]),"right"===E.at[0]?C.left+=P:"center"===E.at[0]&&(C.left+=P/2),"bottom"===E.at[1]?C.top+=R:"center"===E.at[1]&&(C.top+=R/2),s=O(N.at,P,R),C.left+=s[0],C.top+=s[1],this.each(function(){var d,c,p=S(this),a=p.outerWidth(),l=p.outerHeight(),r=T(this,"marginLeft"),e=T(this,"marginTop"),m=a+r+T(this,"marginRight")+G.width,n=l+e+T(this,"marginBottom")+G.height,g=S.extend({},C),o=O(N.my,p.outerWidth(),p.outerHeight());"right"===E.my[0]?g.left-=a:"center"===E.my[0]&&(g.left-=a/2),"bottom"===E.my[1]?g.top-=l:"center"===E.my[1]&&(g.top-=l/2),g.left+=o[0],g.top+=o[1],d={marginLeft:r,marginTop:e},S.each(["left","top"],function(r,t){S.ui.position[Y[r]]&&S.ui.position[Y[r]][t](g,{targetWidth:P,targetHeight:R,elemWidth:a,elemHeight:l,collisionPosition:d,collisionWidth:m,collisionHeight:n,offset:[s[0]+o[0],s[1]+o[1]],my:E.my,at:E.at,within:D,elem:p})}),E.using&&(c=function(r){var t=h.left-g.left,e=t+P-a,i=h.top-g.top,s=i+R-l,n={target:{element:A,left:h.left,top:h.top,width:P,height:R},element:{element:p,left:g.left,top:g.top,width:a,height:l},horizontal:0>e?"left":0<t?"right":"center",vertical:0>s?"top":0<i?"bottom":"middle"};P<a&&v(t+e)<P&&(n.horizontal="center"),R<l&&v(i+s)<R&&(n.vertical="middle"),n.important=_(v(t),v(e))>_(v(i),v(s))?"horizontal":"vertical",E.using.call(this,r,n)}),p.offset(S.extend(g,{using:c}))})},S.ui.position={fit:{left:function(r,t){var e=t.within,d=e.isWindow?e.scrollLeft:e.offset.left,s=e.width,n=r.left-t.collisionPosition.marginLeft,o=d-n,a=n+t.collisionWidth-s-d;t.collisionWidth>s?0<o&&0>=a?(e=r.left+o+t.collisionWidth-s-d,r.left+=o-e):r.left=!(0<a&&0>=o)&&a<o?d+s-t.collisionWidth:d:0<o?r.left+=o:0<a?r.left-=a:r.left=_(r.left-n,r.left)},top:function(r,t){var e=t.within,d=e.isWindow?e.scrollTop:e.offset.top,s=t.within.height,n=r.top-t.collisionPosition.marginTop,o=d-n,a=n+t.collisionHeight-s-d;t.collisionHeight>s?0<o&&0>=a?(e=r.top+o+t.collisionHeight-s-d,r.top+=o-e):r.top=!(0<a&&0>=o)&&a<o?d+s-t.collisionHeight:d:0<o?r.top+=o:0<a?r.top-=a:r.top=_(r.top-n,r.top)}},flip:{left:function(d,t){var e=t.within,c=e.offset.left+e.scrollLeft,p=e.width,n=e.isWindow?e.scrollLeft:e.offset.left,m=d.left-t.collisionPosition.marginLeft,g=m-n,l=m+t.collisionWidth-p-n,r="left"===t.my[0]?-t.elemWidth:"right"===t.my[0]?t.elemWidth:0,e="left"===t.at[0]?t.targetWidth:"right"===t.at[0]?-t.targetWidth:0,m=-2*t.offset[0];0>g?(0>(c=d.left+r+e+m+t.collisionWidth-p-c)||c<v(g))&&(d.left+=r+e+m):0<l&&(0<(n=d.left-t.collisionPosition.marginLeft+r+e+m-n)||v(n)<l)&&(d.left+=r+e+m)},top:function(d,t){var e=t.within,c=e.offset.top+e.scrollTop,p=e.height,n=e.isWindow?e.scrollTop:e.offset.top,m=d.top-t.collisionPosition.marginTop,g=m-n,l=m+t.collisionHeight-p-n,r="top"===t.my[1]?-t.elemHeight:"bottom"===t.my[1]?t.elemHeight:0,e="top"===t.at[1]?t.targetHeight:"bottom"===t.at[1]?-t.targetHeight:0,m=-2*t.offset[1];0>g?(0>(c=d.top+r+e+m+t.collisionHeight-p-c)||c<v(g))&&(d.top+=r+e+m):0<l&&(0<(n=d.top-t.collisionPosition.marginTop+r+e+m-n)||v(n)<l)&&(d.top+=r+e+m)}},flipfit:{left:function(){S.ui.position.flip.left.apply(this,arguments),S.ui.position.fit.left.apply(this,arguments)},top:function(){S.ui.position.flip.top.apply(this,arguments),S.ui.position.fit.top.apply(this,arguments)}}},S.ui.position,"1.7"===S.fn.jquery.substring(0,3)&&(S.each(["Width","Height"],function(e,r){function i(o,t,n,r){return S.each(a,function(){t-=parseFloat(S.css(o,"padding"+this))||0,n&&(t-=parseFloat(S.css(o,"border"+this+"Width"))||0),r&&(t-=parseFloat(S.css(o,"margin"+this))||0)}),t}var a="Width"===r?["Left","Right"]:["Top","Bottom"],n=r.toLowerCase(),s={innerWidth:S.fn.innerWidth,innerHeight:S.fn.innerHeight,outerWidth:S.fn.outerWidth,outerHeight:S.fn.outerHeight};S.fn["inner"+r]=function(e){return void 0===e?s["inner"+r].call(this):this.each(function(){S(this).css(n,i(this,e)+"px")})},S.fn["outer"+r]=function(a,t){return"number"==typeof a?this.each(function(){S(this).css(n,i(this,a,!0,t)+"px")}):s["outer"+r].call(this,a)}}),S.fn.addBack=function(e){return this.add(null==e?this.prevObject:this.prevObject.filter(e))});var e;S.ui.keyCode={BACKSPACE:8,COMMA:188,DELETE:46,DOWN:40,END:35,ENTER:13,ESCAPE:27,HOME:36,LEFT:37,PAGE_DOWN:34,PAGE_UP:33,PERIOD:190,RIGHT:39,SPACE:32,TAB:9,UP:38},S.fn.extend({uniqueId:(e=0,function(){return this.each(function(){this.id||(this.id="ui-id-"+ ++e)})}),removeUniqueId:function(){return this.each(function(){/^ui-id-\d+$/.test(this.id)&&S(this).removeAttr("id")})}}),S.ui.safeActiveElement=function(a){var e;try{e=a.activeElement}catch(o){e=a.body}return(e=e||a.body).nodeName||(e=a.body),e},S.widget("ui.menu",{version:"1.12.1",defaultElement:"<ul>",delay:300,options:{icons:{submenu:"ui-icon-caret-1-e"},items:"> *",menus:"ul",position:{my:"left top",at:"right top"},role:"menu",blur:null,focus:null,select:null},_create:function(){this.activeMenu=this.element,this.mouseHandled=!1,this.element.uniqueId().attr({role:this.options.role,tabIndex:0}),this._addClass("ui-menu","ui-widget ui-widget-content"),this._on({"mousedown .ui-menu-item":function(e){e.preventDefault()},"click .ui-menu-item":function(a){var t=S(a.target),e=S(S.ui.safeActiveElement(this.document[0]));!this.mouseHandled&&t.not(".ui-state-disabled").length&&(this.select(a),a.isPropagationStopped()||(this.mouseHandled=!0),t.has(".ui-menu").length?this.expand(a):!this.element.is(":focus")&&e.closest(".ui-menu").length&&(this.element.trigger("focus",[!0]),this.active&&1===this.active.parents(".ui-menu").length&&clearTimeout(this.timer)))},"mouseenter .ui-menu-item":function(a){var t,o;this.previousFilter||(t=S(a.target).closest(".ui-menu-item"),o=S(a.currentTarget),t[0]===o[0]&&(this._removeClass(o.siblings().children(".ui-state-active"),null,"ui-state-active"),this.focus(a,o)))},mouseleave:"collapseAll","mouseleave .ui-menu":"collapseAll",focus:function(a,t){var e=this.active||this.element.find(this.options.items).eq(0);t||this.focus(a,e)},blur:function(e){this._delay(function(){S.contains(this.element[0],S.ui.safeActiveElement(this.document[0]))||this.collapseAll(e)})},keydown:"_keydown"}),this.refresh(),this._on(this.document,{click:function(e){this._closeOnDocumentClick(e)&&this.collapseAll(e),this.mouseHandled=!1}})},_destroy:function(){var e=this.element.find(".ui-menu-item").removeAttr("role aria-disabled").children(".ui-menu-item-wrapper").removeUniqueId().removeAttr("tabIndex role aria-haspopup");this.element.removeAttr("aria-activedescendant").find(".ui-menu").addBack().removeAttr("role aria-labelledby aria-expanded aria-hidden aria-disabled tabIndex").removeUniqueId().show(),e.children().each(function(){var e=S(this);e.data("ui-menu-submenu-caret")&&e.remove()})},_keydown:function(a){var t,o,r,l=!0;switch(a.keyCode){case S.ui.keyCode.PAGE_UP:this.previousPage(a);break;case S.ui.keyCode.PAGE_DOWN:this.nextPage(a);break;case S.ui.keyCode.HOME:this._move("first","first",a);break;case S.ui.keyCode.END:this._move("last","last",a);break;case S.ui.keyCode.UP:this.previous(a);break;case S.ui.keyCode.DOWN:this.next(a);break;case S.ui.keyCode.LEFT:this.collapse(a);break;case S.ui.keyCode.RIGHT:this.active&&!this.active.is(".ui-state-disabled")&&this.expand(a);break;case S.ui.keyCode.ENTER:case S.ui.keyCode.SPACE:this._activate(a);break;case S.ui.keyCode.ESCAPE:this.collapse(a);break;default:l=!1,t=this.previousFilter||"",r=!1,o=96<=a.keyCode&&105>=a.keyCode?(a.keyCode-96).toString():String.fromCharCode(a.keyCode),clearTimeout(this.filterTimer),o===t?r=!0:o=t+o,t=this._filterMenuItems(o),(t=r&&-1!==t.index(this.active.next())?this.active.nextAll(".ui-menu-item"):t).length||(o=String.fromCharCode(a.keyCode),t=this._filterMenuItems(o)),t.length?(this.focus(a,t),this.previousFilter=o,this.filterTimer=this._delay(function(){delete this.previousFilter},1e3)):delete this.previousFilter;}l&&a.preventDefault()},_activate:function(e){this.active&&!this.active.is(".ui-state-disabled")&&(this.active.children("[aria-haspopup='true']").length?this.expand(e):this.select(e))},refresh:function(){var a,o,r=this,s=this.options.icons.submenu,n=this.element.find(this.options.menus);this._toggleClass("ui-menu-icons",null,!!this.element.find(".ui-icon").length),o=n.filter(":not(.ui-menu)").hide().attr({role:this.options.role,"aria-hidden":"true","aria-expanded":"false"}).each(function(){var a=S(this),t=a.prev(),e=S("<span>").data("ui-menu-submenu-caret",!0);r._addClass(e,"ui-menu-icon","ui-icon "+s),t.attr("aria-haspopup","true").prepend(e),a.attr("aria-labelledby",t.attr("id"))}),this._addClass(o,"ui-menu","ui-widget ui-widget-content ui-front"),(a=n.add(this.element).find(this.options.items)).not(".ui-menu-item").each(function(){var e=S(this);r._isDivider(e)&&r._addClass(e,"ui-menu-divider","ui-widget-content")}),n=(o=a.not(".ui-menu-item, .ui-menu-divider")).children().not(".ui-menu").uniqueId().attr({tabIndex:-1,role:this._itemRole()}),this._addClass(o,"ui-menu-item")._addClass(n,"ui-menu-item-wrapper"),a.filter(".ui-state-disabled").attr("aria-disabled","true"),this.active&&!S.contains(this.element[0],this.active[0])&&this.blur()},_itemRole:function(){return{menu:"menuitem",listbox:"option"}[this.options.role]},_setOption:function(a,t){var e;"icons"===a&&(e=this.element.find(".ui-menu-icon"),this._removeClass(e,null,this.options.icons.submenu)._addClass(e,null,t.submenu)),this._super(a,t)},_setOptionDisabled:function(e){this._super(e),this.element.attr("aria-disabled",e+""),this._toggleClass(null,"ui-state-disabled",!!e)},focus:function(a,t){var e;this.blur(a,a&&"focus"===a.type),this._scrollIntoView(t),this.active=t.first(),e=this.active.children(".ui-menu-item-wrapper"),this._addClass(e,null,"ui-state-active"),this.options.role&&this.element.attr("aria-activedescendant",e.attr("id")),e=this.active.parent().closest(".ui-menu-item").children(".ui-menu-item-wrapper"),this._addClass(e,null,"ui-state-active"),a&&"keydown"===a.type?this._close():this.timer=this._delay(function(){this._close()},this.delay),(e=t.children(".ui-menu")).length&&a&&/^mouse/.test(a.type)&&this._startOpening(e),this.activeMenu=t.parent(),this._trigger("focus",a,{item:t})},_scrollIntoView:function(a){var o,n,r;this._hasScroll()&&(n=parseFloat(S.css(this.activeMenu[0],"borderTopWidth"))||0,r=parseFloat(S.css(this.activeMenu[0],"paddingTop"))||0,o=a.offset().top-this.activeMenu.offset().top-n-r,n=this.activeMenu.scrollTop(),r=this.activeMenu.height(),a=a.outerHeight(),0>o?this.activeMenu.scrollTop(n+o):r<o+a&&this.activeMenu.scrollTop(n+o-r+a))},blur:function(a,t){t||clearTimeout(this.timer),this.active&&(this._removeClass(this.active.children(".ui-menu-item-wrapper"),null,"ui-state-active"),this._trigger("blur",a,{item:this.active}),this.active=null)},_startOpening:function(e){clearTimeout(this.timer),"true"===e.attr("aria-hidden")&&(this.timer=this._delay(function(){this._close(),this._open(e)},this.delay))},_open:function(a){var t=S.extend({of:this.active},this.options.position);clearTimeout(this.timer),this.element.find(".ui-menu").not(a.parents(".ui-menu")).hide().attr("aria-hidden","true"),a.show().removeAttr("aria-hidden").attr("aria-expanded","true").position(t)},collapseAll:function(a,e){clearTimeout(this.timer),this.timer=this._delay(function(){var o=e?this.element:S(a&&a.target).closest(this.element.find(".ui-menu"));o.length||(o=this.element),this._close(o),this.blur(a),this._removeClass(o.find(".ui-state-active"),null,"ui-state-active"),this.activeMenu=o},this.delay)},_close:function(e){(e=e||(this.active?this.active.parent():this.element)).find(".ui-menu").hide().attr("aria-hidden","true").attr("aria-expanded","false")},_closeOnDocumentClick:function(e){return!S(e.target).closest(".ui-menu").length},_isDivider:function(e){return!/[^\-\u2014\u2013\s]/.test(e.text())},collapse:function(a){var t=this.active&&this.active.parent().closest(".ui-menu-item",this.element);t&&t.length&&(this._close(),this.focus(a,t))},expand:function(a){var t=this.active&&this.active.children(".ui-menu ").find(this.options.items).first();t&&t.length&&(this._open(t.parent()),this._delay(function(){this.focus(a,t)}))},next:function(e){this._move("next","first",e)},previous:function(e){this._move("prev","last",e)},isFirstItem:function(){return this.active&&!this.active.prevAll(".ui-menu-item").length},isLastItem:function(){return this.active&&!this.active.nextAll(".ui-menu-item").length},_move:function(a,t,e){var o;this.active&&(o="first"===a||"last"===a?this.active["first"===a?"prevAll":"nextAll"](".ui-menu-item").eq(-1):this.active[a+"All"](".ui-menu-item").eq(0)),o&&o.length&&this.active||(o=this.activeMenu.find(this.options.items)[t]()),this.focus(e,o)},nextPage:function(a){var t,o,n;this.active?this.isLastItem()||(this._hasScroll()?(o=this.active.offset().top,n=this.element.height(),this.active.nextAll(".ui-menu-item").each(function(){return 0>(t=S(this)).offset().top-o-n}),this.focus(a,t)):this.focus(a,this.activeMenu.find(this.options.items)[this.active?"last":"first"]())):this.next(a)},previousPage:function(a){var t,o,n;this.active?this.isFirstItem()||(this._hasScroll()?(o=this.active.offset().top,n=this.element.height(),this.active.prevAll(".ui-menu-item").each(function(){return 0<(t=S(this)).offset().top-o+n}),this.focus(a,t)):this.focus(a,this.activeMenu.find(this.options.items).first())):this.next(a)},_hasScroll:function(){return this.element.outerHeight()<this.element.prop("scrollHeight")},select:function(a){this.active=this.active||S(a.target).closest(".ui-menu-item");var t={item:this.active};this.active.has(".ui-menu").length||this.collapseAll(a,!0),this._trigger("select",a,t)},_filterMenuItems:function(a){var a=a.replace(/[\-\[\]{}()*+?.,\\\^$|#\s]/g,"\\$&"),o=new RegExp("^"+a,"i");return this.activeMenu.find(this.options.items).filter(".ui-menu-item").filter(function(){return o.test(S.trim(S(this).children(".ui-menu-item-wrapper").text()))})}}),S.widget("ui.autocomplete",{version:"1.12.1",defaultElement:"<input>",options:{appendTo:null,autoFocus:!1,delay:300,minLength:1,position:{my:"left top",at:"left bottom",collision:"none"},source:null,change:null,close:null,focus:null,open:null,response:null,search:null,select:null},requestIndex:0,pending:0,_create:function(){var a,o,r,l=this.element[0].nodeName.toLowerCase(),d="textarea"===l,l="input"===l;this.isMultiLine=d||!l&&this._isContentEditable(this.element),this.valueMethod=this.element[d||l?"val":"text"],this.isNewMenu=!0,this._addClass("ui-autocomplete-input"),this.element.attr("autocomplete","off"),this._on(this.element,{keydown:function(n){if(this.element.prop("readOnly"))o=r=a=!0;else{o=r=a=!1;var t=S.ui.keyCode;switch(n.keyCode){case t.PAGE_UP:a=!0,this._move("previousPage",n);break;case t.PAGE_DOWN:a=!0,this._move("nextPage",n);break;case t.UP:a=!0,this._keyEvent("previous",n);break;case t.DOWN:a=!0,this._keyEvent("next",n);break;case t.ENTER:this.menu.active&&(a=!0,n.preventDefault(),this.menu.select(n));break;case t.TAB:this.menu.active&&this.menu.select(n);break;case t.ESCAPE:this.menu.element.is(":visible")&&(this.isMultiLine||this._value(this.term),this.close(n),n.preventDefault());break;default:o=!0,this._searchTimeout(n);}}},keypress:function(n){if(a)return a=!1,void(this.isMultiLine&&!this.menu.element.is(":visible")||n.preventDefault());if(!o){var t=S.ui.keyCode;switch(n.keyCode){case t.PAGE_UP:this._move("previousPage",n);break;case t.PAGE_DOWN:this._move("nextPage",n);break;case t.UP:this._keyEvent("previous",n);break;case t.DOWN:this._keyEvent("next",n);}}},input:function(e){return r?(r=!1,void e.preventDefault()):void this._searchTimeout(e)},focus:function(){this.selectedItem=null,this.previous=this._value()},blur:function(e){this.cancelBlur?delete this.cancelBlur:(clearTimeout(this.searching),this.close(e),this._change(e))}}),this._initSource(),this.menu=S("<ul>").appendTo(this._appendTo()).menu({role:null}).hide().menu("instance"),this._addClass(this.menu.element,"ui-autocomplete","ui-front"),this._on(this.menu.element,{mousedown:function(e){e.preventDefault(),this.cancelBlur=!0,this._delay(function(){delete this.cancelBlur,this.element[0]!==S.ui.safeActiveElement(this.document[0])&&this.element.trigger("focus")})},menufocus:function(a,t){var e;return this.isNewMenu&&(this.isNewMenu=!1,a.originalEvent&&/^mouse/.test(a.originalEvent.type))?(this.menu.blur(),void this.document.one("mousemove",function(){S(a.target).trigger(a.originalEvent)})):void(e=t.item.data("ui-autocomplete-item"),!1!==this._trigger("focus",a,{item:e})&&a.originalEvent&&/^key/.test(a.originalEvent.type)&&this._value(e.value),(e=t.item.attr("aria-label")||e.value)&&S.trim(e).length&&(this.liveRegion.children().hide(),S("<div>").text(e).appendTo(this.liveRegion)))},menuselect:function(a,t){var e=t.item.data("ui-autocomplete-item"),o=this.previous;this.element[0]!==S.ui.safeActiveElement(this.document[0])&&(this.element.trigger("focus"),this.previous=o,this._delay(function(){this.previous=o,this.selectedItem=e})),!1!==this._trigger("select",a,{item:e})&&this._value(e.value),this.term=this._value(),this.close(a),this.selectedItem=e}}),this.liveRegion=S("<div>",{role:"status","aria-live":"assertive","aria-relevant":"additions"}).appendTo(this.document[0].body),this._addClass(this.liveRegion,null,"ui-helper-hidden-accessible"),this._on(this.window,{beforeunload:function(){this.element.removeAttr("autocomplete")}})},_destroy:function(){clearTimeout(this.searching),this.element.removeAttr("autocomplete"),this.menu.element.remove(),this.liveRegion.remove()},_setOption:function(a,t){this._super(a,t),"source"===a&&this._initSource(),"appendTo"===a&&this.menu.element.appendTo(this._appendTo()),"disabled"===a&&t&&this.xhr&&this.xhr.abort()},_isEventTargetInWidget:function(a){var t=this.menu.element[0];return a.target===this.element[0]||a.target===t||S.contains(t,a.target)},_closeOnClickOutside:function(e){this._isEventTargetInWidget(e)||this.close()},_appendTo:function(){var e=this.options.appendTo;return(e=e&&(e.jquery||e.nodeType?S(e):this.document.find(e).eq(0)))&&e[0]||(e=this.element.closest(".ui-front, dialog")),e.length||(e=this.document[0].body),e},_initSource:function(){var a,o,r=this;S.isArray(this.options.source)?(a=this.options.source,this.source=function(o,t){t(S.ui.autocomplete.filter(a,o.term))}):"string"==typeof this.options.source?(o=this.options.source,this.source=function(a,n){r.xhr&&r.xhr.abort(),r.xhr=S.ajax({url:o,data:a,dataType:"json",success:function(e){n(e)},error:function(){n([])}})}):this.source=this.options.source},_searchTimeout:function(a){clearTimeout(this.searching),this.searching=this._delay(function(){var o=this.term===this._value(),t=this.menu.element.is(":visible"),e=a.altKey||a.ctrlKey||a.metaKey||a.shiftKey;o&&(!o||t||e)||(this.selectedItem=null,this.search(null,a))},this.options.delay)},search:function(a,o){return a=null==a?this._value():a,this.term=this._value(),a.length<this.options.minLength?this.close(o):!1===this._trigger("search",o)?void 0:this._search(a)},_search:function(e){this.pending++,this._addClass("ui-autocomplete-loading"),this.cancelSearch=!1,this.source({term:e},this._response())},_response:function(){var a=++this.requestIndex;return S.proxy(function(e){a===this.requestIndex&&this.__response(e),this.pending--,this.pending||this._removeClass("ui-autocomplete-loading")},this)},__response:function(e){e=e&&this._normalize(e),this._trigger("response",null,{content:e}),!this.options.disabled&&e&&e.length&&!this.cancelSearch?(this._suggest(e),this._trigger("open")):this._close()},close:function(e){this.cancelSearch=!0,this._close(e)},_close:function(e){this._off(this.document,"mousedown"),this.menu.element.is(":visible")&&(this.menu.element.hide(),this.menu.blur(),this.isNewMenu=!0,this._trigger("close",e))},_change:function(e){this.previous!==this._value()&&this._trigger("change",e,{item:this.selectedItem})},_normalize:function(e){return e.length&&e[0].label&&e[0].value?e:S.map(e,function(e){return"string"==typeof e?{label:e,value:e}:S.extend({},e,{label:e.label||e.value,value:e.value||e.label})})},_suggest:function(a){var t=this.menu.element.empty();this._renderMenu(t,a),this.isNewMenu=!0,this.menu.refresh(),t.show(),this._resizeMenu(),t.position(S.extend({of:this.element},this.options.position)),this.options.autoFocus&&this.menu.next(),this._on(this.document,{mousedown:"_closeOnClickOutside"})},_resizeMenu:function(){var e=this.menu.element;e.outerWidth(Math.max(e.width("").outerWidth()+1,this.element.outerWidth()))},_renderMenu:function(a,e){var o=this;S.each(e,function(n,t){o._renderItemData(a,t)})},_renderItemData:function(a,t){return this._renderItem(a,t).data("ui-autocomplete-item",t)},_renderItem:function(a,t){return S("<li>").append(S("<div>").text(t.label)).appendTo(a)},_move:function(a,t){return this.menu.element.is(":visible")?this.menu.isFirstItem()&&/^previous/.test(a)||this.menu.isLastItem()&&/^next/.test(a)?(this.isMultiLine||this._value(this.term),void this.menu.blur()):void this.menu[a](t):void this.search(null,t)},widget:function(){return this.menu.element},_value:function(){return this.valueMethod.apply(this.element,arguments)},_keyEvent:function(a,t){this.isMultiLine&&!this.menu.element.is(":visible")||(this._move(a,t),t.preventDefault())},_isContentEditable:function(a){if(!a.length)return!1;var t=a.prop("contentEditable");return"inherit"===t?this._isContentEditable(a.parent()):"true"===t}}),S.extend(S.ui.autocomplete,{escapeRegex:function(e){return e.replace(/[\-\[\]{}()*+?.,\\\^$|#\s]/g,"\\$&")},filter:function(a,t){var e=new RegExp(S.ui.autocomplete.escapeRegex(t),"i");return S.grep(a,function(a){return e.test(a.label||a.value||a)})}}),S.widget("ui.autocomplete",S.ui.autocomplete,{options:{messages:{noResults:"No search results.",results:function(e){return e+(1<e?" results are":" result is")+" available, use up and down arrow keys to navigate."}}},__response:function(a){var t;this._superApply(arguments),this.options.disabled||this.cancelSearch||(t=a&&a.length?this.options.messages.results(a.length):this.options.messages.noResults,this.liveRegion.children().hide(),S("<div>").text(t).appendTo(this.liveRegion))}}),S.ui.autocomplete});function forceIntegerInput(e){var t=e.val(),a=t.indexOf(".");return-1!==a&&(t=e.val().slice(0,a),e.val(t)),t}function LoadingScreen(){this.$view=$("#loading-screen")}LoadingScreen.prototype.enable=function(){this.$view.show()},LoadingScreen.prototype.disable=function(){this.$view.hide()},loadingScreen=new LoadingScreen;function shake(e){var t=10;e.css("position","relative");for(var a=0;a<4+1;a++)e.animate({left:0==a%2?t:-1*t},100);e.animate({left:0},100)}function Socket(){this.socket=void 0,this.observers={},this.spamCheckFunctions=[constant_data.MSG_TYPES.BROWSER_UPDATE,constant_data.MSG_TYPES.MESSAGE,constant_data.MSG_TYPES.GUESS],this.antiSpam=3e3,this.antiSpamRemove=5,this.maxSpam=7,this.spamScore=0,setInterval(this.spamCountdown.bind(this),this.antiSpam)}Socket.prototype.setup=function(){this.socket=io(),this.socket.on(constant_data.MSG_TYPES.ERROR,(...e)=>this.alertObservers(constant_data.MSG_TYPES.ERROR,!0,...e)),this.socket.on(constant_data.MSG_TYPES.USER_DATA,(...e)=>this.alertObservers(constant_data.MSG_TYPES.USER_DATA,!1,...e)),this.socket.on(constant_data.MSG_TYPES.ALREADY_LOGGED,(...e)=>this.alertObservers(constant_data.MSG_TYPES.ALREADY_LOGGED,!1,...e)),this.socket.on(constant_data.MSG_TYPES.RECONNECT_ROOM,(...e)=>this.alertObservers(constant_data.MSG_TYPES.RECONNECT_ROOM,!1,...e)),this.socket.on(constant_data.MSG_TYPES.UPDATE_ANIME_LIST,(...e)=>this.alertObservers(constant_data.MSG_TYPES.UPDATE_ANIME_LIST,!1,...e)),this.socket.on(constant_data.MSG_TYPES.BROWSER_UPDATE,(...e)=>this.alertObservers(constant_data.MSG_TYPES.BROWSER_UPDATE,!0,...e)),this.socket.on(constant_data.MSG_TYPES.GET_ANIME_NAMES,(...e)=>this.alertObservers(constant_data.MSG_TYPES.GET_ANIME_NAMES,!1,...e)),this.socket.on(constant_data.MSG_TYPES.CREATE_ROOM,(...e)=>this.alertObservers(constant_data.MSG_TYPES.CREATE_ROOM,!0,...e)),this.socket.on(constant_data.MSG_TYPES.JOIN_ROOM,(...e)=>this.alertObservers(constant_data.MSG_TYPES.JOIN_ROOM,!0,...e)),this.socket.on(constant_data.MSG_TYPES.MESSAGE,(...e)=>this.alertObservers(constant_data.MSG_TYPES.MESSAGE,!1,...e)),this.socket.on(constant_data.MSG_TYPES.ADD_PLAYER,(...e)=>this.alertObservers(constant_data.MSG_TYPES.ADD_PLAYER,!1,...e)),this.socket.on(constant_data.MSG_TYPES.REMOVE_PLAYER,(...e)=>this.alertObservers(constant_data.MSG_TYPES.REMOVE_PLAYER,!1,...e)),this.socket.on(constant_data.MSG_TYPES.REMOVE_PLAYERS,(...e)=>this.alertObservers(constant_data.MSG_TYPES.REMOVE_PLAYERS,!1,...e)),this.socket.on(constant_data.MSG_TYPES.LEAVE_ROOM,(...e)=>this.alertObservers(constant_data.MSG_TYPES.LEAVE_ROOM,!0,...e)),this.socket.on(constant_data.MSG_TYPES.UPDATE_ROOM,(...e)=>this.alertObservers(constant_data.MSG_TYPES.UPDATE_ROOM,!0,...e)),this.socket.on(constant_data.MSG_TYPES.START_GAME,(...e)=>this.alertObservers(constant_data.MSG_TYPES.START_GAME,!0,...e)),this.socket.on(constant_data.MSG_TYPES.NEW_OWNER,(...e)=>this.alertObservers(constant_data.MSG_TYPES.NEW_OWNER,!1,...e)),this.socket.on(constant_data.MSG_TYPES.NEW_ROUND,(...e)=>this.alertObservers(constant_data.MSG_TYPES.NEW_ROUND,!1,...e)),this.socket.on(constant_data.MSG_TYPES.NEW_DRAWER,(...e)=>this.alertObservers(constant_data.MSG_TYPES.NEW_DRAWER,!1,...e)),this.socket.on(constant_data.MSG_TYPES.WORDS_CHOICE,(...e)=>this.alertObservers(constant_data.MSG_TYPES.WORDS_CHOICE,!1,...e)),this.socket.on(constant_data.MSG_TYPES.START_DRAW_D,(...e)=>this.alertObservers(constant_data.MSG_TYPES.START_DRAW_D,!1,...e)),this.socket.on(constant_data.MSG_TYPES.START_DRAW,(...e)=>this.alertObservers(constant_data.MSG_TYPES.START_DRAW,!1,...e)),this.socket.on(constant_data.MSG_TYPES.DRAW,(...e)=>this.alertObservers(constant_data.MSG_TYPES.DRAW,!1,...e)),this.socket.on(constant_data.MSG_TYPES.DRAW_CLEAR,(...e)=>this.alertObservers(constant_data.MSG_TYPES.DRAW_CLEAR,!1,...e)),this.socket.on(constant_data.MSG_TYPES.GUESS,(...e)=>this.alertObservers(constant_data.MSG_TYPES.GUESS,!1,...e)),this.socket.on(constant_data.MSG_TYPES.P_GUESSED_T,(...e)=>this.alertObservers(constant_data.MSG_TYPES.P_GUESSED_T,!1,...e)),this.socket.on(constant_data.MSG_TYPES.END_TURN,(...e)=>this.alertObservers(constant_data.MSG_TYPES.END_TURN,!1,...e)),this.socket.on(constant_data.MSG_TYPES.PLAYER_DISCONNECTED,(...e)=>this.alertObservers(constant_data.MSG_TYPES.PLAYER_DISCONNECTED,!1,...e)),this.socket.on(constant_data.MSG_TYPES.PLAYER_RECONNECTED,(...e)=>this.alertObservers(constant_data.MSG_TYPES.PLAYER_RECONNECTED,!1,...e)),this.socket.on(constant_data.MSG_TYPES.END_GAME,(...e)=>this.alertObservers(constant_data.MSG_TYPES.END_GAME,!1,...e)),this.socket.on(constant_data.MSG_TYPES.BACK_TO_LOBBY,(...e)=>this.alertObservers(constant_data.MSG_TYPES.BACK_TO_LOBBY,!1,...e)),this.socket.on(constant_data.MSG_TYPES.BACK_TO_LOBBY_VOTE,(...e)=>this.alertObservers(constant_data.MSG_TYPES.BACK_TO_LOBBY_VOTE,!1,...e)),this.socket.on(constant_data.MSG_TYPES.END_BTL_VOTE,(...e)=>this.alertObservers(constant_data.MSG_TYPES.END_BTL_VOTE,!1,...e))},Socket.prototype.emit=function(e,t,...a){return t&&loadingScreen.enable(),this.checkSpam(e)?this.alertObservers(constant_data.MSG_TYPES.SPAM_ALERT,!1):void this.socket.emit(e,...a)},Socket.prototype.addObserver=function(e,t){this.observers[e]||(this.observers[e]=[]),this.observers[e].push(t)},Socket.prototype.alertObservers=function(e,t,...a){let o=this.observers[e];if(o){for(var n=0;n<o.length;n++)o[n](...a);t&&loadingScreen.disable()}},Socket.prototype.checkSpam=function(e){if(-1!==this.spamCheckFunctions.indexOf(e)){if(this.spamScore>=this.maxSpam)return!0;this.addSpam()}return!1},Socket.prototype.addSpam=function(){this.spamScore+=1},Socket.prototype.spamCountdown=function(){0<this.spamScore&&(this.spamScore-=this.antiSpamRemove,0>this.spamScore&&(this.spamScore=0))};var socket=new Socket;function ErrorHandler(){this.observers={},socket.addObserver(constant_data.MSG_TYPES.ERROR,(...e)=>this.display.call(this,...e)),socket.addObserver(constant_data.MSG_TYPES.LEAVE_ROOM,(...e)=>this.onLeaveRoom.call(this,...e)),socket.addObserver(constant_data.MSG_TYPES.ALREADY_LOGGED,(...e)=>this.alreadyLogged.call(this,...e)),socket.addObserver(constant_data.MSG_TYPES.RECONNECT_ROOM,(...e)=>this.reconnectToRoom.call(this,...e))}ErrorHandler.prototype.display=function(e,t=null){Swal.fire({icon:"error",text:e}),t&&this.alertObservers(t)},ErrorHandler.prototype.addObserver=function(e,t){this.observers[e]||(this.observers[e]=[]),this.observers[e].push(t)},ErrorHandler.prototype.alertObservers=function(e){let t=this.observers[e];if(t)for(var a=0;a<t.length;a++)t[a]()},ErrorHandler.prototype.onLeaveRoom=function(e=null){null!==e&&this.display("You have been kicked from the room")},ErrorHandler.prototype.alreadyLogged=function(){Swal.fire({icon:"warning",title:"Already logged in",text:"You are already logged in in another tab, do you want to continue anyway?",confirmButtonText:`contine anyway`,allowOutsideClick:!1}).then(e=>{e.isConfirmed&&socket.emit(constant_data.MSG_TYPES.ALREADY_LOGGED,!0)})},ErrorHandler.prototype.reconnectToRoom=function(){Swal.fire({icon:"info",title:"You are in an ongoing game",text:"You are in an ongoing game, do you wish to reconnect?",showDenyButton:!0,confirmButtonText:`Yes`,denyButtonText:`No`,allowOutsideClick:!1}).then(e=>{e.isConfirmed?socket.emit(constant_data.MSG_TYPES.RECONNECT_ROOM,!0,!0):socket.emit(constant_data.MSG_TYPES.RECONNECT_ROOM,!0,!1)})};var errorHandler=new ErrorHandler;function SceneTransitioner(){this.$roombrowser=$("#roombrowser"),this.$liParent=$("#crig"),this.$lobby=$("#customroom"),this.$ingame=$("#ingame"),this.$activeScene=this.$roombrowser,socket.addObserver(constant_data.MSG_TYPES.CREATE_ROOM,()=>this.goToLobby.call(this)),socket.addObserver(constant_data.MSG_TYPES.JOIN_ROOM,(...e)=>this.joinRoom.call(this,...e)),socket.addObserver(constant_data.MSG_TYPES.START_GAME,()=>this.goToIngame.call(this)),socket.addObserver(constant_data.MSG_TYPES.BACK_TO_LOBBY,()=>this.goToLobby.call(this))}SceneTransitioner.prototype.joinRoom=function(e){e.ingame?this.goToIngame():this.goToLobby()},SceneTransitioner.prototype.goToLobby=function(){this.$activeScene.hide(),this.$liParent.show(),this.$lobby.show(),this.$activeScene=this.$lobby,window.onbeforeunload=function(){return"Are you sure you want to an ongoing game?"}},SceneTransitioner.prototype.goToIngame=function(){this.$activeScene.hide(),this.$liParent.show(),this.$ingame.show(),this.$activeScene=this.$ingame,window.onbeforeunload=function(){return"Are you sure you want to an ongoing game?"}},SceneTransitioner.prototype.goToRoomBrowser=function(){this.$liParent.hide(),this.$activeScene.hide(),this.$roombrowser.show(),this.$activeScene=this.$roombrowser,window.onbeforeunload=function(){}};var sceneTransitioner=new SceneTransitioner;function UserData(){this.accountid=0,this.username="0",socket.addObserver(constant_data.MSG_TYPES.USER_DATA,(...e)=>this.setup.call(this,...e)),socket.addObserver(constant_data.MSG_TYPES.RECONNECT_ROOM,(...e)=>this.setup.call(this,...e))}UserData.prototype.description=function(){return{accountid:this.accountid,username:this.username,score:0}},UserData.prototype.minDesc=function(){var e={};return e[this.accountid]=this.username,e},UserData.prototype.isPlayer=function(e){return"string"==typeof e&&(e=parseInt(e,10)),this.accountid===e},UserData.prototype.setup=function(e){this.accountid=parseInt(e.accountid,10),this.username=e.username};var userData=new UserData;function TopWindow(){this.$view=$("#top-window"),this.$openhostRoomBtn=$("#hostgame-but"),this.$openRoomSetBtn=$(".open-roomSettings"),this.$openAccSetBtn=$("#open_Accsettings_but"),this.$closeViewBtns=$(".closewindowBtn"),this.$hostPage=$("#host-room-w"),this.$accountSettingsPage=$("#account-settings"),this.$roomSettingsPage=$("#room-settings"),this.$navButtons=$(".nav_btn"),this.$rsDefNav=$("#rs-general-nav"),this.$rsDeftab=$("#rs-general"),this.$asDefNav=$("#acc-general-nav"),this.$asDeftab=$("#acc-general"),this.$activeView=null,this.$oldNavHigh=null,this.$oldTab=null,this.$navButtons.click(t=>{this.changeTab($("#"+t.target.id),$("#"+t.target.id.substring(0,t.target.id.length-4)))}),this.$openAccSetBtn.click(()=>this.openAccountSettings.call(this)),this.$openRoomSetBtn.click(()=>this.openRoomSettings.call(this)),this.$openhostRoomBtn.click(()=>this.openHostPage.call(this)),this.$closeViewBtns.click(()=>this.close.call(this))}TopWindow.prototype.changeTab=function(e,t){this.$oldTab.hide(),t.show(),this.$oldNavHigh.removeClass("highlightedNav"),e.addClass("highlightedNav"),this.$oldTab=t,this.$oldNavHigh=e},TopWindow.prototype.helpFunction=function(e,t,a){this.$view.show(),e.show(),this.$activeView=e,t!==void 0&&a!==void 0&&(this.$oldNavHigh=t,this.$oldTab=a,this.$oldNavHigh.show(),this.$oldNavHigh.addClass("highlightedNav"),this.$oldTab.show())},TopWindow.prototype.openHostPage=function(){this.helpFunction(this.$hostPage)},TopWindow.prototype.openAccountSettings=function(){this.helpFunction(this.$accountSettingsPage,this.$asDefNav,this.$asDeftab)},TopWindow.prototype.openRoomSettings=function(){this.helpFunction(this.$roomSettingsPage,this.$rsDefNav,this.$rsDeftab)},TopWindow.prototype.close=function(){null!=this.$oldNavHigh&&null!=this.$oldTab&&(this.$oldTab.hide(),this.$oldNavHigh.removeClass("highlightedNav")),this.$view.hide(),this.$activeView.hide(),this.$oldNavHigh=null,this.$oldTab=null};var topWindow=new TopWindow;function RbRoom(e,t,a){this.roomData=e,this.$selector=null,this.filterCheck=function(e){for(const[a,o]of Object.entries(e))if(!0!==o){var t=!0;switch(a+""){case"name":t=!this.roomData.name.startsWith(o);break;case"full":t=this.roomData.ing_players===this.roomData.max_players;break;case"langs":t=!o.includes(this.roomData.lang);break;default:t=this.roomData[a];}if(t)return void this.disable()}this.enable()}.bind(this),this.addRoomToBrowser(t),this.filterCheck(a)}RbRoom.prototype.enable=function(){this.$selector.show()},RbRoom.prototype.disable=function(){this.$selector.hide()},RbRoom.prototype.addRoomToBrowser=function(e){var t="robr-"+this.roomData.id,a=$("<div></div>").addClass("room-box").attr("id",t),o=this.setupTitlebox(),n=this.setupMiddleData(),s=this.setupButtons();a.append(o).append(n).append(s),e.append(a),this.$selector=a},RbRoom.prototype.setupTitlebox=function(){var e="";e=this.roomData.ingame?"ingame":"in lobby";var t=$("<div></div>").addClass("rb-title");if(this.roomData.locked){var a=$("<img src=\"https://cdn.inkdove.com/images/lock.png\" data-toggle=\"tooltip\" data-placement=\"top\" title=\"Locked\" class=\"lock_icon_rb\"/>");t.append(a)}var o=$("<p></p>").addClass("room-title").html(this.roomData.name),n=$("<div></div>").addClass("double-equals-columns"),s=$("<div></div>").addClass("forms-half"),r=$("<p></p>").addClass("state-text").html(e);s.append(r),n.append(s),s=$("<div></div>").addClass("forms-half");var i=$("<p></p>").addClass("state-text").html("Round: "+this.roomData.ing_round+"/"+this.roomData.rounds);return s.append(i),n.append(s),t.append(o).append(n),t},RbRoom.prototype.setupMiddleData=function(){var e=$("<div></div>").addClass("rb-data"),t=$("<div></div>").addClass("double-equals-columns rb-data-top"),a=$("<div></div>").addClass("forms-half"),o=$("<p></p>").addClass("room-text").html("Host: "+this.roomData.owner);a.append(o),t.append(a),a=$("<div style=\"align-items: center;\"></div>").addClass("forms-half centered-title");var n=$("<img class=\"lan-icon\" src=\"https://cdn.inkdove.com/images/flags/"+this.roomData.lang+".jpg\" data-toggle=\"tooltip\" data-placement=\"right\">");a.append(n),t.append(a);var s=$("<p></p>").addClass("room-text").html("Players: "+this.roomData.ing_players+"/"+this.roomData.max_players),r=$("<div></div>").addClass("filler-box"),i=$("<div></div>").addClass("type-icons");return this.roomData.di_enabled&&i.append($("<img class=\"game-icon\" src=\"https://cdn.inkdove.com/images/themes/dic.png\" data-toggle=\"tooltip\" data-placement=\"top\" title=\"Dictionary\">")),this.roomData.an_enabled&&i.append($("<img class=\"game-icon rounded\" src=\"https://cdn.inkdove.com/images/themes/an.png\" data-toggle=\"tooltip\" data-placement=\"top\" title=\"Anime\">")),this.roomData.lol_enabled&&i.append($("<img class=\"game-icon\" src=\"https://cdn.inkdove.com/images/themes/lol.png\" data-toggle=\"tooltip\" data-placement=\"top\" title=\"League of legends\">")),this.roomData.hs_enabled&&i.append($("<img class=\"game-icon\" src=\"https://cdn.inkdove.com/images/themes/hs.png\" data-toggle=\"tooltip\" data-placement=\"top\" title=\"hearthstone\">")),e.append(t).append(s).append(r).append(i),e},RbRoom.prototype.setupButtons=function(){var e="jr-"+this.roomData.id,t=$("<div></div>").addClass("rb-buttons"),a="btn btn-outline-custom buttonsStyle";!1===this.roomData.ingame&&(a+=" joinrBut");var o=$("<button type=\"button\" ></button>").addClass(a);return o.attr("id",e).html("Join"),t.append(o)};function Room(){this.mainData={},this.ingameData={},this.players={},this.observers={},this.ownerIsPlayer=function(){return this.mainData.owner===userData.accountid}.bind(this),socket.addObserver(constant_data.MSG_TYPES.CREATE_ROOM,e=>this.setData.call(this,e,[userData.description()])),socket.addObserver(constant_data.MSG_TYPES.JOIN_ROOM,(...e)=>this.setData.call(this,...e)),socket.addObserver(constant_data.MSG_TYPES.ADD_PLAYER,(...e)=>this.addPlayer.call(this,!0,...e)),socket.addObserver(constant_data.MSG_TYPES.REMOVE_PLAYER,(...e)=>this.removePlayer.call(this,...e)),socket.addObserver(constant_data.MSG_TYPES.REMOVE_PLAYERS,(...e)=>this.removePlayers.call(this,...e)),socket.addObserver(constant_data.MSG_TYPES.NEW_OWNER,(...e)=>this.setOwner.call(this,...e))}Room.prototype.setData=function(e,t,a){this.mainData=e,this.players={};for(const[o,n]of Object.entries(t))this.addPlayer(!1,n);this.ingameData=a?a:{ing_round:0,ing_drawer:0,ing_players:1,time:0,ing_word:"_",ing_wordtype:"lol"}},Room.prototype.setOwner=function(e){this.mainData.owner=e},Room.prototype.addPlayer=function(e,t){this.players[t.accountid]=t.username,e&&this.alertObservers(constant_data.MSG_TYPES.ADD_PLAYER,t.accountid)},Room.prototype.removePlayers=function(e){if(e)for(var t=0;t<e.length;t++)delete this.players[e[t].accountid]},Room.prototype.removePlayer=function(e){this.alertObservers(constant_data.MSG_TYPES.REMOVE_PLAYER,e);let t=e.owner;null!==t&&(this.mainData.owner=t),delete this.players[e.accountid]},Room.prototype.addObserver=function(e,t){this.observers[e]||(this.observers[e]=[]),this.observers[e].push(t)},Room.prototype.alertObservers=function(e,...t){let a=this.observers[e];if(a)for(var o=0;o<a.length;o++)a[o](...t)};var room=new Room;function AccountSettings(){this.$accountInp=$("#an-inp"),this.$updateList=$("#updateList-btn"),this.$listType=$("#an-site"),this.$updateDate=$("#ans-date"),this.$anloadingSpinner=$("#anupload"),this.$oldpwd=$("#acc-oldpwd"),this.$newpwd=$("#acc-newpwd"),this.$rnewpwd=$("#acc-newpwdr"),this.$newpwdbtn=$("#acc-updatepwd-btn"),this.$rbTitle=$("#Bug_title_inp"),this.$rbDesc=$("#Bug_Descr_Inp"),this.$rbSend=$("#sendreportbtn"),this.canUpdate=!0,this.$updateList.click(()=>this.updateList.call(this)),this.$rbSend.click(()=>this.sendBugReport.call(this)),this.$newpwdbtn.click(()=>this.changePassword.call(this)),socket.addObserver(constant_data.MSG_TYPES.UPDATE_ANIME_LIST,(...e)=>this.updateListFeedback.call(this,...e)),socket.addObserver(constant_data.MSG_TYPES.USER_DATA,e=>this.setAnimeSettings.call(this,e)),socket.addObserver(constant_data.MSG_TYPES.RECONNECT_ROOM,e=>this.setAnimeSettings.call(this,e)),errorHandler.addObserver(constant_data.MSG_TYPES.UPDATE_ANIME_LIST,()=>this.enableUpdateList.call(this))}AccountSettings.prototype.updateList=function(){return this.canUpdate?void(socket.emit(constant_data.MSG_TYPES.UPDATE_ANIME_LIST,!1,{account:this.$accountInp.val(),type:parseInt(this.$listType.val())}),this.disableUpdateList()):void errorHandler.display("You can not reupdate your list so quickly")},AccountSettings.prototype.disableUpdateList=function(){this.canUpdate=!1,this.$anloadingSpinner.show(),this.$updateList.prop("disabled",!0)},AccountSettings.prototype.enableUpdateList=function(){this.canUpdate=!0,this.$anloadingSpinner.hide(),this.$updateList.prop("disabled",!1)},AccountSettings.prototype.updateListFeedback=function(e){Swal.fire({icon:"success",text:"List successfully updated"}),this.enableUpdateList(),e.account&&this.setAnimeSettings(e)},AccountSettings.prototype.setAnimeSettings=function(e){if(e.animelist){this.$accountInp.val(e.animelist),this.$listType.val(e.animelisttype);let t=new Date(e.listdate);this.$updateDate.html(t.getFullYear()+"-"+(t.getMonth()+1)+"-"+t.getDate())}},AccountSettings.prototype.changePassword=function(){let e=this.$oldpwd.val(),t=this.$newpwd.val(),a=this.$rnewpwd.val();if(t.length<constant_data.MIN_PASSWORD_LENGTH||t.length>constant_data.MAX_PASSWORD_LENGTH)return errorHandler.display("Bad new password, please try a different one");if(t!==a)return errorHandler.display("Passwords do not correspond");loadingScreen.enable();this;return $.ajax({type:"POST",url:"changepwd",data:JSON.stringify({oldPwd:e,newPwd:t}),contentType:"application/json",success:function(){loadingScreen.disable(),Swal.fire({icon:"success",text:"Your password has been successfully updated"})},error:function(e){loadingScreen.disable(),errorHandler.display(e.responseText)}})},AccountSettings.prototype.sendBugReport=function(){let e=this.$rbTitle.val(),t=this.$rbDesc.val();this.$rbSend.prop("disabled",!0),40<e.length&&errorHandler.display("Title too long"),400<t.length&&errorHandler.display("Passwords do not correspond");let a=this;return $.ajax({type:"POST",url:"reportbug",data:JSON.stringify({title:e,description:t}),contentType:"application/json",success:function(){Swal.fire({icon:"success",text:"Your report has been registered ! Thank you"}),a.$rbSend.prop("disabled",!1)},error:function(e){errorHandler.display(e.responseText),a.$rbSend.prop("disabled",!1)}})};var accountSettings=new AccountSettings;function Bottombar(){this.$username=$("#botbar_username"),this.$logoutbtn=$("#logoutbtn"),this.$logoutbtn.click(()=>this.logout.call(this)),socket.addObserver(constant_data.MSG_TYPES.USER_DATA,e=>this.setData.call(this,e)),socket.addObserver(constant_data.MSG_TYPES.RECONNECT_ROOM,e=>this.setData.call(this,e))}Bottombar.prototype.setData=function(e){this.$username.html(e.username)},Bottombar.prototype.logout=function(){loadingScreen.enable(),$.ajax({type:"POST",url:"logout",contentType:"application/json",success:function(){location.reload()},error:function(){location.reload()}})};var bottombar=new Bottombar;function Roombrowser(){this.$refreshRoomBtn=$("#refreshbutton"),this.$container=$("#room-cont"),this.rooms={},this.filters={name:"",ingame:!0,locked:!0,full:!0,langs:[0,1],di_enabled:!0,lol_enabled:!0,an_enabled:!0,hs_enabled:!0},this.roomToJoinId=0,this.$refreshRoomBtn.click(()=>{this.refresh()}),this.$container.on("click",".joinrBut",e=>{var t=e.target.id.substring(3,e.target.id.length);this.roomToJoinId=t,this.rooms[t].roomData.locked?(console.log("room is locked"),this.openJoinPasswordUI()):this.joinRoom()}),this.updateFilter=function(e,t,a=null){if(!("langs"===e))this.filters[e]=t;else if(t)this.filters.langs.push(a);else{var o=this.filters.langs.indexOf(a);-1<o&&this.filters.langs.splice(o,1)}for(const[o,n]of Object.entries(this.rooms))n.filterCheck(this.filters)}.bind(this),socket.addObserver(constant_data.MSG_TYPES.USER_DATA,()=>this.refresh.call(this)),socket.addObserver(constant_data.MSG_TYPES.LEAVE_ROOM,()=>this.refresh.call(this)),socket.addObserver(constant_data.MSG_TYPES.BROWSER_UPDATE,e=>this.refreshCallback.call(this,e)),socket.addObserver(constant_data.MSG_TYPES.SPAM_ALERT,()=>this.enableRefreshBtn.call(this)),errorHandler.addObserver(constant_data.MSG_TYPES.BROWSER_UPDATE,()=>this.enableRefreshBtn.call(this)),errorHandler.addObserver(constant_data.ROOM_DOES_NOT_EXIST,()=>this.refresh.call(this))}Roombrowser.prototype.refresh=function(){this.rooms={},this.$container.empty(),socket.emit(constant_data.MSG_TYPES.BROWSER_UPDATE,!1),this.$refreshRoomBtn.prop("disabled",!0)},Roombrowser.prototype.refreshCallback=function(e){for(var t=0;t<e.length;t++)this.addroom(e[t]);this.enableRefreshBtn()},Roombrowser.prototype.addroom=function(e){this.rooms[e.id]=new RbRoom(e,this.$container,this.filters)},Roombrowser.prototype.openJoinPasswordUI=async function(){const{value:e}=await Swal.fire({title:"Enter room Password",input:"text",inputLabel:"Room password",showCancelButton:!0,confirmButtonText:`Join`,inputValidator:e=>{if(!e)return"Password cannot be null!"}});e&&this.joinRoom(e)},Roombrowser.prototype.disableRefreshBtn=function(){this.$refreshRoomBtn.prop("disabled",!0)},Roombrowser.prototype.enableRefreshBtn=function(){this.$refreshRoomBtn.prop("disabled",!1)},Roombrowser.prototype.joinRoom=function(e=""){var t={id:this.roomToJoinId,password:e};socket.emit(constant_data.MSG_TYPES.JOIN_ROOM,!0,t)};var roombrowser=new Roombrowser;function HostRoom(){this.$hostBtn=$("#host-but-c"),this.$selectors={$name:$("#HR-roomname"),$password:$("#HR-roompass"),$lang:$("#HR-Lan"),$locked:$("#HR-locked"),$di:$("#HR-useDic"),$lol:$("#HR-useLol"),$an:$("#HR-useAn"),$hs:$("#HR-useHs")},this.$hostBtn.click(()=>this.hostRoom.call(this)),this.$selectors.$locked.change(()=>{let e=this.$selectors.$locked.prop("checked");e?this.$selectors.$password.prop("disabled",!1):this.$selectors.$password.prop("disabled",!0)})}HostRoom.prototype.hostRoom=function(){topWindow.close();let e=this.$selectors;var t={name:e.$name.val(),locked:e.$locked.prop("checked"),password:e.$password.val(),lang:parseInt(e.$lang.val()),di_enabled:e.$di.prop("checked"),lol_enabled:e.$lol.prop("checked"),an_enabled:e.$an.prop("checked"),hs_enabled:e.$hs.prop("checked")};t.name.length<constant_data.MIN_ROOMNAME_LENGTH&&errorHandler.display("Room name too short"),socket.emit(constant_data.MSG_TYPES.CREATE_ROOM,!0,t)};var hostRoom=new HostRoom;function RoomFilter(){this.$filters=$(".filterinp"),this.$lanfilters=$(".lanfilter"),this.$search=$("#roomSearchInp"),this.$filters.change(t=>{roombrowser.updateFilter(t.target.id.substring(3,t.target.id.length),$(t.target).prop("checked"))}),this.$lanfilters.change(t=>{roombrowser.updateFilter("langs",$(t.target).prop("checked"),parseInt(t.target.id.substring(3,t.target.id.length)))}),this.$search.keyup(()=>{roombrowser.updateFilter("name",this.$search.val())})}var roomFilter=new RoomFilter;function GameChat(){this.$container=$("#messageCont"),this.$input=$("#message-inp"),this.messageClass="message",this.systemMsgClass="system-message",this.errorMsgClass="error-message",this.msgColorClass="darkText",this.messageID=0,this.$input.keyup(t=>{13==t.keyCode&&this.sendMessage()}),socket.addObserver(constant_data.MSG_TYPES.CREATE_ROOM,()=>this.init.call(this,[userData.description()])),socket.addObserver(constant_data.MSG_TYPES.SPAM_ALERT,()=>this.addErrorMessage.call(this,"Spam detected ! Message/guess was not sent")),socket.addObserver(constant_data.MSG_TYPES.JOIN_ROOM,()=>this.init.call(this)),socket.addObserver(constant_data.MSG_TYPES.MESSAGE,(...e)=>this.addMessage.call(this,...e)),socket.addObserver(constant_data.MSG_TYPES.REMOVE_PLAYERS,()=>this.addSystemMessage.call(this,"All disconnected users have been removed")),socket.addObserver(constant_data.MSG_TYPES.PLAYER_DISCONNECTED,e=>this.addSystemMessage.call(this,"Disconnected",e)),socket.addObserver(constant_data.MSG_TYPES.PLAYER_RECONNECTED,e=>this.addSystemMessage.call(this,"Reconencted",e)),socket.addObserver(constant_data.MSG_TYPES.NEW_ROUND,()=>this.addSystemMessage.call(this,"New round!")),socket.addObserver(constant_data.MSG_TYPES.NEW_OWNER,e=>this.addSystemMessage.call(this,"is the new Owner",e)),socket.addObserver(constant_data.MSG_TYPES.P_GUESSED_T,e=>this.addSystemMessage.call(this,"has guessed the word !",e.accountid)),socket.addObserver(constant_data.MSG_TYPES.UPDATE_ROOM,(...e)=>this.displaySettingsChange.call(this,...e)),socket.addObserver(constant_data.MSG_TYPES.END_TURN,e=>this.addSystemMessage.call(this,"The word was : "+e.word)),socket.addObserver(constant_data.MSG_TYPES.END_GAME,(e=null)=>this.addSystemMessage.call(this,"Game has ended ! Going back to lobby"+(e?"<br> Reason : "+e:""))),socket.addObserver(constant_data.MSG_TYPES.BACK_TO_LOBBY_VOTE,()=>this.addSystemMessage.call(this,"Room owner started vote to go back to lobby")),socket.addObserver(constant_data.MSG_TYPES.END_BTL_VOTE,e=>this.addSystemMessage.call(this,e?"The game will go back to lobby after next turn":"Vote failed, game will continue")),room.addObserver(constant_data.MSG_TYPES.ADD_PLAYER,e=>this.addSystemMessage.call(this,"Joined the room",e)),room.addObserver(constant_data.MSG_TYPES.REMOVE_PLAYER,(...e)=>this.removePlayer.call(this,...e))}GameChat.prototype.init=function(){this.$container.empty()},GameChat.prototype.displaySettingsChange=function(e){var t="Updated Room Settings:<br>";for(const[o,n]of Object.entries(e))if(Array.isArray(n)){t+=SettingToText[o]+" &#8594; ";for(var a=0;a<n.length;a++)0!=a&&(t+=", "),t+=""+arrayVals[o][n[a]];t+="<br>"}else t+=SettingToText[o]+" &#8594; "+n+"<br>";var o=$("<p class=\"system-message\">"+t+"<p>");this.$container.append(o)},GameChat.prototype.removePlayer=function(e){this.addSystemMessage.call(this,e.m,e.accountid),null!==e.owner&&this.addSystemMessage.call(this,"is the new owner",e.owner),delete room.players[e.accountid]},GameChat.prototype.addMessage=function(e){var t=e.m,a=e.accountid,o=room.players[a];if(o===void 0)return console.log("received message but userid was not defined");var n=$("<p></p>").addClass(this.messageClass);1==this.messageID&&n.addClass(this.msgColorClass),n.html(o+": "+t),this.messageID=(this.messageID+1)%2,this.$container.append(n),this.scrollDown()},GameChat.prototype.sendMessage=function(){var e=this.$input.val();return 0>=e.length||e.length>constant_data.MAX_MESSAGE_LENGTH?void(1<e.length&&this.addSystemMessage.call(this,"your message is too long and can't be sent")):void(this.clearInput(),socket.emit(constant_data.MSG_TYPES.MESSAGE,!1,e))},GameChat.prototype.clearInput=function(){this.$input.val("")},GameChat.prototype.addSystemMessage=function(e,t){t&&(e=room.players[t]+" "+e);var a=$("<p></p>").addClass(this.systemMsgClass).html(e);this.$container.append(a),this.scrollDown()},GameChat.prototype.addErrorMessage=function(e){var t=$("<p></p>").addClass(this.errorMsgClass).html(e);this.$container.append(t),this.scrollDown()},GameChat.prototype.scrollDown=function(){this.$container.scrollTop(this.$container[0].scrollHeight)};const SettingToText={name:"Room name",locked:"Room locked",password:"Password",owner:"Room owner",show_wortype:"Show word type",lang:"Language",rounds:"Total rounds",drawtime:"Draw time",max_players:"Max players",di_enabled:"Use Dictionary",di_type:"Dictionary: Word types",an_enabled:"Use Anime",an_shared:"Anime: Only shared",an_sequels:"Anime: allow sequels",an_format:"Anime: Format",an_genre:"Anime: Banned Genres",an_froms:"Anime: from season",an_fromy:"Anime: from year",an_tos:"Anime: to season",an_toy:"Anime: to year",lol_enabled:"Use League of legends",lol_type:"LOL: word types",hs_enabled:"Use Hearthstone",hs_type:"HS: Card type",hs_rarity:"HS: Card rarity",hs_set:"HS: Card sets"},arrayVals={an_genre:{0:"Action",1:"Adventure",2:"Comedy",3:"Drama",4:"Ecchi",5:"Fantasy",6:"Hentai",7:"Horror",8:"Mahou Shoujo",9:"Mecha",10:"Music",11:"Mystery",12:"Psychological",13:"Romance",14:"Sci-Fi",15:"Slice of Life",16:"Sports",17:"Supernatural",18:"Thriller"},an_format:{0:"TV",1:"TV_SHORT",2:"MOVIE",3:"SPECIAL",4:"OVA",5:"ONA"},lol_type:{0:"champions",1:"items"},hs_type:{0:"Hero",1:"Minion",2:"Spell",3:"Weapon"},hs_rarity:{0:"Free",1:"Common",2:"Rare",3:"Epic",4:"Legendary"},hs_set:{0:"Basic",1:"Classic",2:"Naxxramas",3:"Goblins vs Gnomes",4:"Blackrock Mountain",5:"The Grand Tournament",6:"The League of Explorers",7:"Whispers of the Old Gods",8:"One Night in Karazhan",9:"Mean Streets of Gadgetzan",10:"Journey to Un'Goro",11:"Knights of the Frozen Throne",12:"Kobolds & Catacombs",13:"The Witchwood",14:"The Boomsday Project",15:"Rastakhan's Rumble",16:"Rise of Shadows",17:"Saviors of Uldum",18:"Descent of Dragons",19:"Galakrond's Awakening",20:"Demon Hunter Initiate",21:"Ashes of Outland",22:"Scholomance Academy",23:"Madness At The Darkmoon Faire",24:"Battlegrounds"},di_type:{0:"random words/verbs",1:"Countries"}};var gameChat=new GameChat;function RoomSettings(){this.$container=$("#room-settings"),this.rs_prefix="#rs-",this.$closebtn=$("#close-roomSettings"),this.$savebtn=$("#save-roomSettings"),this.$options=$(".rs-vals"),this.$constrainedOps=$(".rs-valsCs"),this.$animeYear={$fromyear:$("#rs-an_fromy"),$fromSeason:$("#rs-an_froms"),$toYear:$("#rs-an_toy"),$toSeason:$("#rs-an_tos")},this.localChanges={},this.$closebtn.click(()=>this.close.call(this)),this.$savebtn.click(()=>this.save.call(this)),this.$options.change(e=>{this.addChange($(e.target),e.target.id)}),this.$constrainedOps.change(e=>{var t=$(e.target),a=t.attr("name");a.startsWith("an_")&&(this.animeYearHandler(),this.addChange(t,e.target.id))}),socket.addObserver(constant_data.MSG_TYPES.UPDATE_ROOM,(...e)=>this.update.call(this,...e)),socket.addObserver(constant_data.MSG_TYPES.CREATE_ROOM,e=>this.joinRoomcb.call(this,e,!0)),socket.addObserver(constant_data.MSG_TYPES.JOIN_ROOM,(e,t=null)=>this.joinRoomcb.call(this,e,!1)),socket.addObserver(constant_data.MSG_TYPES.REMOVE_PLAYER,e=>this.onOwnerUpdate.call(this,e.owner)),socket.addObserver(constant_data.MSG_TYPES.NEW_OWNER,(...e)=>this.onOwnerUpdate.call(this,...e)),socket.addObserver(constant_data.MSG_TYPES.START_GAME,()=>this.disable.call(this)),socket.addObserver(constant_data.MSG_TYPES.BACK_TO_LOBBY,()=>this.enableIfOwner.call(this))}RoomSettings.prototype.update=function(e){this.assignValues(e)},RoomSettings.prototype.joinRoomcb=function(e,t){t?this.enable():this.disable(),this.update(e)},RoomSettings.prototype.onOwnerUpdate=function(e){null===e||(userData.isPlayer(e)?this.enable():this.disable())},RoomSettings.prototype.disable=function(){this.$options.prop("disabled",!0),this.$constrainedOps.prop("disabled",!0)},RoomSettings.prototype.enable=function(){this.$options.prop("disabled",!1),this.$constrainedOps.prop("disabled",!0)},RoomSettings.prototype.enableIfOwner=function(){room.ownerIsPlayer&&this.enable()},RoomSettings.prototype.animeYearHandler=function(){var e=forceIntegerInput(this.$animeYear.$fromyear),t=forceIntegerInput(this.$animeYear.$toYear);if(this.$animeYear.$fromyear.attr("max",t),this.$animeYear.$toYear.attr("min",e),e===t){var a=parseInt(this.$animeYear.$fromSeason.val()),o=parseInt(this.$animeYear.$toSeason.val());a>o&&this.$animeYear.$fromSeason(o)}},RoomSettings.prototype.save=function(){if(topWindow.close(),!jQuery.isEmptyObject(this.localChanges)&&room.ownerIsPlayer()){for(const[o,n]of Object.entries(this.localChanges))if(Array.isArray(n)){for(var e=room.mainData[o],t=!0,a=0;a<n.length;a++)if(e.indexOf(-1===n[a])){t=!1;break}t&&delete this.localChanges[o]}else n===room.mainData[o]&&delete this.localChanges[o];jQuery.isEmptyObject(this.localChanges)||(socket.emit(constant_data.MSG_TYPES.UPDATE_ROOM,!0,this.localChanges),this.localChanges={})}},RoomSettings.prototype.close=function(){topWindow.close(),room.ownerIsPlayer()&&this.resetLocalChanges()},RoomSettings.prototype.addChange=function(e){var t,a=e.attr("name");if("!"===a[0]){t=parseInt(e.attr("value")),a=a.substring(1,a.length),this.localChanges[a]||(this.localChanges[a]=room.mainData[a].slice());var o=e.prop("checked");o?this.localChanges[a].push(t):this.localChanges[a].splice(this.localChanges[a].indexOf(t),1)}else e.is(":checkbox")?(t=e.prop("checked"),this.localChanges[a]=t):(t=e.val(),this.localChanges[a]=t)},RoomSettings.prototype.resetLocalChanges=function(){this.localChanges={},this.assignValues(room.mainData)},RoomSettings.prototype.assignValues=function(e){for(const[a,o]of Object.entries(e)){var t=$(this.rs_prefix+a);if(!Array.isArray(o))0===t.length||(t.is(":checkbox")?t.prop("checked",o):t.val(o));else{this.rs_prefix+a;t.find(".rs-vals").each(function(){let e=parseInt($(this).val(),10);o.includes(e)?$(this).prop("checked",!0):$(this).prop("checked",!1)})}}};var roomSettings=new RoomSettings;function Lobby(){this.$container=$("#container-players"),this.ownerActionClass="ownerOnly",this.$container.on("click",".lkickbtn",e=>{this.kickPlayer($(e.target).val())}),this.$container.on("click",".lgiveownbtn",e=>{this.makeOwner($(e.target).val())}),socket.addObserver(constant_data.MSG_TYPES.CREATE_ROOM,(...e)=>this.createRoomCb.call(this,...e)),socket.addObserver(constant_data.MSG_TYPES.JOIN_ROOM,(...e)=>this.joinRoomCb.call(this,...e)),socket.addObserver(constant_data.MSG_TYPES.ADD_PLAYER,(...e)=>this.addPlayerCb.call(this,...e)),socket.addObserver(constant_data.MSG_TYPES.REMOVE_PLAYER,(...e)=>this.removePlayer.call(this,...e)),socket.addObserver(constant_data.MSG_TYPES.REMOVE_PLAYERS,(...e)=>this.removeMultiplePlayers.call(this,...e)),socket.addObserver(constant_data.MSG_TYPES.NEW_OWNER,(...e)=>this.setOwner.call(this,...e)),errorHandler.addObserver(constant_data.MSG_TYPES.NEW_OWNER,()=>this.enableOwnerBtns.call(this))}Lobby.prototype.createRoomCb=function(e){this.$container.empty(),this.addPlayer(userData.description(),e),this.enableOwnerBtns()},Lobby.prototype.joinRoomCb=function(e,t){this.$container.empty();for(const[a,o]of Object.entries(t))this.addPlayer(o,e)},Lobby.prototype.addPlayerCb=function(e){this.addPlayer(e,room.mainData)},Lobby.prototype.removePlayer=function(e){var t=e.accountid,a=e.owner;this.$container.find("#lb-"+t).remove(),null!==a&&this.setOwner(a)},Lobby.prototype.setOwner=function(e){this.$container.find(".owner").remove(),this.$container.find("#lb-"+e).append($("<div></div>").addClass("owner-text owner").html("Owner")),userData.isPlayer(e)?this.enableOwnerBtns():this.disableOwnerBtns()},Lobby.prototype.removeMultiplePlayers=function(e){for(var t=0;t<e.length;t++)this.removePlayer(e[t])},Lobby.prototype.enableOwnerBtns=function(){this.$container.find("."+this.ownerActionClass).prop("disabled",!1)},Lobby.prototype.disableOwnerBtns=function(){this.$container.find("."+this.ownerActionClass).prop("disabled",!0)},Lobby.prototype.addPlayer=function(e,t){var a="lb-"+e.accountid,o=$("<div></div>").addClass("player-info-lobby").attr("id",a),n=$("<img class=\"player-avatar rounded-circle\" src=\"https://cdn.inkdove.com/images/face.png\" alt=\"Italian Trulli\">"),s=e.accountid===userData.accountid,r="";r=s?"<div></div>":"<div data-toggle=\"dropdown\"></div>";var i=$("<div></div>").addClass("room-dropdown"),l=$(r).addClass("username-room").html(e.username);if(i.append(l),!s){var d=$("<div style=\"background-color: inherit;\"></div>").addClass("dropdown-menu"),c=$("<button></button>").addClass("dropdown-item ownerOnly lkickbtn").val(e.accountid).html("Kick Player"),p=$("<button></button>").addClass("dropdown-item ownerOnly lgiveownbtn").val(e.accountid).html("Give ownership");room.ownerIsPlayer()||(c.prop("disabled",!0),p.prop("disabled",!0)),d.append(c),d.append(p),i.append(d)}o.append(n).append(i),t.owner===e.accountid&&o.append($("<div></div>").addClass("owner-text owner").html("Owner")),this.$container.append(o)},Lobby.prototype.transitionToGame=function(e,t,a){SetDisabledInput(a),a?hideOwnerButtons():showOwnerButtons(),roomData.ingame?GoToIngame():GoToLobby()},Lobby.prototype.kickPlayer=function(e){room.ownerIsPlayer()&&socket.emit(constant_data.MSG_TYPES.REMOVE_PLAYER,!1,e)},Lobby.prototype.makeOwner=function(e){room.ownerIsPlayer()&&(socket.emit(constant_data.MSG_TYPES.NEW_OWNER,!1,e),this.disableOwnerBtns())};var lobby=new Lobby;const Singleregexes={pi:"(pi|\u03C0)",a:"[a\xE0\xE1\xE2\xE3\xE4\u0105\xE5\u03B1@\uFF41]",b:"[b\u03B2]",c:"[c\u0107\xE7]",e:"[e\xE8\xE9\xEA\xEB\u0113]",i:"[i\xEC\u2171\xED\xEE\xEF\u0131\u01D0\u012B\u0142]",k:"[k\u03BA]",n:"[n\xF1]",o:"[o\xF2\xF3\xF4\xF5\xF6\xF8\xF0]",u:"[u\xFA\xFC]",x:"[x\xD7\u03C7]",u:"[u\u03BC\xF9\xFB\u01D4]",s:"[s\u015B\u015F]",m:"[]",m:"[]"," ":"(-|\u2212|\u2013|\u2014|\u2015|\uFF0A|~|\uFF5E|\u25B3|\u25BD|\u25CE|\u2192|\u2026|\u2606|\u2605|\u2640|\u2661|\u2665|\u266A|\u266D|\u2020|\u221E|\u2200|\u03C8|\u2027|\u301C|\u309C\u0301|\uFF06|\u3010|\u3011|\u221A|\u223D|\u25A1|\u25C7|\xAE|\u3008|\u3009|\xA5|\u300E|\u300F|\xB0|\uFF0F| )","!":"[!\u203C\uFF01\xA1]","?":"\u200B[?\uFF1F\xBF]",1:"[\xBD1\u2159]",2:"[2\xB2]",3:"[3\xB3]","'":"[\u2018\u2019]",'"':"[\u201C\u201D\"]","+":"[+\uFF0B\xB1]","=":"[=\uFF1D\u2260]"},combiRegex={oo:"(oo|\u014D)",ß:"(\xDF|ss)",ou:"(ou|\u014D)",uu:"(\u016B|uu)",ae:"(\xE6|ae)",oe:"(\u0153|oe)"};function GenerateAnimeRegex(e){for(const[t,a]of Object.entries(combiRegex))e.replaceAll(t,a);for(const[t,a]of Object.entries(Singleregexes))e.replaceAll(new RegExp(t,"gi"),a);return e}function normalize(e){for(var t="",a=0;a<e.length;a++)t+=accentMap[e.charAt(a)]||e.charAt(a);return t}function AutoComplete(e){this.$inputSelector=e,this.words=[],this.$inputSelector.autocomplete({source:function(e,t){var a=new RegExp($.ui.autocomplete.escapeRegex(e.term),"i");let o=GenerateAnimeRegex(a);var n=$.ui.autocomplete.filter(this.words,o);t(n.slice(0,10))}.bind(this),minLength:2}),socket.addObserver(constant_data.MSG_TYPES.START_GAME,(...e)=>this.ready.call(this)),socket.addObserver(constant_data.MSG_TYPES.GET_ANIME_NAMES,(...e)=>this.readyAnime.call(this,...e))}AutoComplete.prototype.ready=function(){let e=room.mainData.an_enabled;return 0==this.words.length&&e?socket.emit(constant_data.MSG_TYPES.GET_ANIME_NAMES,!1):void(e?this.$inputSelector.autocomplete({disabled:!1}):this.$inputSelector.autocomplete({disabled:!0}))},AutoComplete.prototype.readyAnime=async function(e){this.words=e.split("\r\n");0===this.words.length||this.ready()};function Canvas(){this.$canvas=$("#myCanvas"),this.$colorbtns=$(".color-b"),this.$widthbtns=$(".sizebtn"),this.$instrumentbtns=$(".drawop-btn"),this.$eraserBtn=$("#eraser"),this.$floodfillBtn=$("#floodfill"),this.$clearbtn=$("#clear-canv"),this.$customColor=$("#cus-color"),this.canDraw=!1,this.sendInterval=5,this.stack=[],this.receivedStack=[],this.intervalObj=null,this.lastX=0,this.lastY=0,this.color="#000000",this.state=0,this.width=2,this.cursor="cu_cus",this.mousePressed=!1,this.$selectedColor=$("#initCanvasBtn"),this.eraserColor="#f2f3f3",this.eraserWidth=14,socket.addObserver(constant_data.MSG_TYPES.JOIN_ROOM,(e,t,a=null)=>this.joinRoomcb.call(this,a)),socket.addObserver(constant_data.MSG_TYPES.END_TURN,(...e)=>this.disable.call(this,...e)),socket.addObserver(constant_data.MSG_TYPES.DRAW_CLEAR,(...e)=>this.clear.call(this,...e)),socket.addObserver(constant_data.MSG_TYPES.DRAW,(...e)=>this.drawReceived.call(this,...e)),socket.addObserver(constant_data.MSG_TYPES.NEW_DRAWER,(...e)=>this.clear.call(this,...e)),socket.addObserver(constant_data.MSG_TYPES.WORDS_CHOICE,(...e)=>this.clear.call(this,...e)),socket.addObserver(constant_data.MSG_TYPES.START_DRAW,(...e)=>this.startHearing.call(this,...e)),socket.addObserver(constant_data.MSG_TYPES.START_DRAW_D,(...e)=>this.startDrawing.call(this,...e)),this.ctx=this.$canvas[0].getContext("2d"),this.$colorbtns.each(function(){$(this).css("background-color",$(this).val())}),this.$canvas.mouseup(()=>{this.mousePressed=!1}),this.$canvas.mouseleave(()=>{this.mousePressed=!1}),this.$colorbtns.click(t=>{this.color=$(t.target).val(),$(t.target).addClass("selected_color"),this.$selectedColor.removeClass("selected_color"),this.$selectedColor=$(t.target)}),this.$customColor.change(t=>{this.color=this.$customColor.val(),$(t.target).addClass("selected_color"),this.$selectedColor.removeClass("selected_color"),this.$selectedColor=$(t.target)}),this.$selectedInstrument=$(".drawop-btn"),this.$instrumentbtns.click(t=>{$(t.target).addClass("selected_instrument"),this.$selectedInstrument.removeClass("selected_instrument"),this.$selectedInstrument=$(t.target)}),this.$widthbtns.click(t=>{this.state=0;var e="cu_"+t.target.id;this.changeCursor.call(this,e),this.width=$(t.target).val()}),this.$eraserBtn.click(()=>{this.state=1,this.changeCursor.call(this,"cu_eraser")}),this.$floodfillBtn.click(()=>{this.state=2,this.changeCursor.call(this,"cu_bucket")}),this.$canvas.mousedown(t=>{this.canDraw&&(this.mousePressed=!0,this.localDraw.call(this,t.clientX-$(t.target).offset().left,t.clientY-$(t.target).offset().top,!1))}),this.$canvas.mousemove(t=>{this.mousePressed&&this.canDraw&&this.localDraw.call(this,t.clientX-$(t.target).offset().left,t.clientY-$(t.target).offset().top,!0)}),this.$clearbtn.click(()=>{this.canDraw&&(socket.emit(constant_data.MSG_TYPES.DRAW_CLEAR,!1),this.clear())})}Canvas.prototype.joinRoomcb=function(e){this.clear(),this.canDraw=!1;null===e||(this.receivedStack=e.picture,this.setNonDrawerInterval())},Canvas.prototype.startDrawing=function(){this.enable(),this.setDrawerInterval()},Canvas.prototype.startHearing=function(){this.disable(),this.setNonDrawerInterval()},Canvas.prototype.drawReceived=function(e){this.receivedStack.push(e)},Canvas.prototype.localDraw=function(e,t,a){var o;o=a&&0===this.state?{x:e,y:t,c:this.color,w:this.width}:a&&1===this.state?{x:e,y:t,c:this.eraserColor,w:this.eraserWidth}:a||2!==this.state?{x:e,y:t}:{x:e,y:t,c:this.color},o.s=this.state,this.stack.push(o),this.executeDraw(o)},Canvas.prototype.executeDraw=function(e){switch(e.s){case 0:case 1:this.paint(e);break;case 2:console.log(e),this.floodfill(e);}},Canvas.prototype.changeCursor=function(e){this.$canvas.removeClass(this.cursor),this.$canvas.addClass(e),this.cursor=e},Canvas.prototype.paint=function(e){e.x&&e.y&&(e.hasOwnProperty("c")&&(this.ctx.beginPath(),this.ctx.strokeStyle=e.c,this.ctx.lineWidth=e.w,this.ctx.lineJoin="round",this.ctx.moveTo(this.lastX,this.lastY),this.ctx.lineTo(e.x,e.y),this.ctx.closePath(),this.ctx.stroke()),this.lastX=e.x,this.lastY=e.y)},Canvas.prototype.floodfill=function(e){if(!e.c)return;let t=e.c,a=Math.floor(e.x),o=Math.floor(e.y),n=this.$canvas[0].width,s=this.$canvas[0].height;var r=this.ctx.getImageData(0,0,n,s);let i=[];const l=this.HexToColor(t),d=this.getPixel(r,4*(o*r.width+a));if(!this.compareColors(d,l,1)){for(i.push(a,o);0<i.length;){const e=i.pop(),t=i.pop();let a=4*(e*r.width+t);if(0>a)continue;let o=this.getPixel(r,a);o&&this.compareColors(o,d,1)&&(this.setPixel(r,a,l),i.push(t+1,e),i.push(t-1,e),i.push(t,e+1),i.push(t,e-1))}this.ctx.putImageData(r,0,0)}},Canvas.prototype.getPixel=function(e,t){return 0>t||t>e.data.length?null:e.data.slice(t,t+4)},Canvas.prototype.setPixel=function(e,t,a){e.data[t+0]=a[0],e.data[t+1]=a[1],e.data[t+2]=a[2],e.data[t+3]=255},Canvas.prototype.compareColors=function(e,t,a){if(null===e)return!1;const o=e[0]-t[0],n=e[1]-t[1],s=e[2]-t[2];return o*o+n*n+s*s<a},Canvas.prototype.HexToColor=function(e){return e.replace(/^#?([a-f\d])([a-f\d])([a-f\d])$/i,(e,t,a,o)=>"#"+t+t+a+a+o+o).substring(1).match(/.{2}/g).map(e=>parseInt(e,16))},Canvas.prototype.setDrawerInterval=function(){null!==this.intervalObj&&clearInterval(this.intervalObj),this.intervalObj=setInterval(function(e){if(0!==e.stack.length)if(8<e.stack.length){var t=e.stack.splice(8);socket.emit(constant_data.MSG_TYPES.DRAW,!1,e.stack),e.stack=t}else socket.emit(constant_data.MSG_TYPES.DRAW,!1,e.stack),e.stack=[]},this.sendInterval,this)},Canvas.prototype.setNonDrawerInterval=function(){null!==this.intervalObj&&clearInterval(this.intervalObj),this.intervalObj=setInterval(function(e){0!==e.receivedStack.length&&e.executeDraw.call(e,e.receivedStack.shift()[0])},5,this)},Canvas.prototype.enable=function(){this.canDraw=!0},Canvas.prototype.disable=function(){this.canDraw=!1},Canvas.prototype.clear=function(){this.stack=[],this.receivedStack=[],this.ctx.setTransform(1,0,0,1,0,0),this.ctx.clearRect(0,0,this.ctx.canvas.width,this.ctx.canvas.height)},this.canvas=new Canvas;function FFVote(){this.$selector=$("#ffBox"),this.$voteSelector=$("#ffvote"),this.$resultSelector=$("#ffres"),this.$timebar=$("#fftime"),this.$yes=$("#gbtlbtn-y"),this.$no=$("#gbtlbtn-n"),this.$timebar.css("--duration",constant_data.BTL_VOTE_DURATION),this.$yes.click(()=>this.CastVote(this.$yes,!0)),this.$no.click(()=>this.CastVote(this.$yes,!1)),socket.addObserver(constant_data.MSG_TYPES.BACK_TO_LOBBY_VOTE,(...e)=>this.StartVote.call(this,...e)),socket.addObserver(constant_data.MSG_TYPES.END_BTL_VOTE,(...e)=>this.DisplayResult.call(this,...e))}FFVote.prototype.StartVote=function(){this.$timebar.removeClass("round-time-bar"),this.$timebar.offsetWidth,this.$timebar.addClass("round-time-bar"),this.$yes.prop("disabled",!1),this.$no.prop("disabled",!1),this.$resultSelector.hide(),this.$voteSelector.show(),this.$selector.show()},FFVote.prototype.CastVote=function(e,t){this.$yes.prop("disabled",!0),this.$no.prop("disabled",!0),e.addClass("active-vote"),socket.emit(constant_data.MSG_TYPES.BACK_TO_LOBBY_VOTE,!1,t)},FFVote.prototype.DisplayResult=function(e){e?this.$resultSelector.html("Vote passed: Going back to lobby after this turn"):this.$resultSelector.html("Vote failed: Game will continue"),this.$voteSelector.hide(),this.$resultSelector.show(),setTimeout(this.Hide.bind(this),5000)},FFVote.prototype.Hide=function(){this.$yes.removeClass("active-vote"),this.$no.removeClass("active-vote"),this.$selector.hide()};var ffvote=new FFVote;function GuessWord(){this.$input=$("#guess-text"),this.autocomplete=new AutoComplete(this.$input),this.$input.keyup(t=>{13==t.keyCode&&this.sendGuess(this.$input.val())}),socket.addObserver(constant_data.MSG_TYPES.GUESS,(...e)=>this.guessCb.call(this,...e)),socket.addObserver(constant_data.MSG_TYPES.JOIN_ROOM,(...e)=>this.enable.call(this,...e)),socket.addObserver(constant_data.MSG_TYPES.END_TURN,(...e)=>this.disable.call(this,...e)),socket.addObserver(constant_data.MSG_TYPES.START_DRAW,(...e)=>this.enable.call(this,...e)),socket.addObserver(constant_data.MSG_TYPES.START_DRAW_D,(...e)=>this.disable.call(this,...e)),socket.addObserver(constant_data.MSG_TYPES.SPAM_ALERT,()=>this.enable.call(this))}GuessWord.prototype.sendGuess=function(e){0>=e.length||(this.disable(),socket.emit(constant_data.MSG_TYPES.GUESS,!1,e),this.clear())},GuessWord.prototype.guessCb=function(e){e.result?this.disable():(shake(this.$input),this.enable(),this.$input.focus())},GuessWord.prototype.clear=function(){this.$input.val("")},GuessWord.prototype.disable=function(){this.$input.prop("disabled",!0)},GuessWord.prototype.enable=function(){this.$input.prop("disabled",!1)};var guessWord=new GuessWord;function Hintsbar(){this.$container=$("#word-hints-container"),this.$roundDisplay=$("#round-display"),this.$wordTypeDisplay=$("#wordtype-display"),this.$timerDisplay=$("#time-display"),this.$hintDisplay=$("#wordHint-display"),this.turntime=10,this.round=1,this.timerInterval=null,socket.addObserver(constant_data.MSG_TYPES.JOIN_ROOM,(...e)=>this.joinRoomCb.call(this,...e)),socket.addObserver(constant_data.MSG_TYPES.END_TURN,e=>this.endTurn.call(this,e.word,null)),socket.addObserver(constant_data.MSG_TYPES.NEW_DRAWER,(...e)=>this.displayDrawer.call(this,...e)),socket.addObserver(constant_data.MSG_TYPES.NEW_ROUND,(...e)=>this.newRound.call(this,...e)),socket.addObserver(constant_data.MSG_TYPES.START_GAME,(...e)=>this.startGame.call(this,...e)),socket.addObserver(constant_data.MSG_TYPES.START_DRAW,(...e)=>this.turnStart.call(this,...e)),socket.addObserver(constant_data.MSG_TYPES.START_DRAW_D,(...e)=>this.turnStart.call(this,...e)),socket.addObserver(constant_data.MSG_TYPES.GUESS,(...e)=>this.guessCb.call(this,...e))}Hintsbar.prototype.joinRoomCb=function(e,t,a){if(a)switch(this.turntime=e.drawtime,this.round=e.ing_round,this.$roundDisplay.html(e.ing_round),this.$timerDisplay.html(a.timer),this.setTimer(a.timer),a.state){case roomStates.PICKING_WORD:this.displayDrawer({username:t[a.ing_drawer].username});break;case roomStates.DRAWING:this.$hintDisplay.html(a.ing_word);break;case roomStates.ENDING_TURN:this.endTurn(a.ing_word);}},Hintsbar.prototype.startGame=function(){this.round=0,this.turntime=room.mainData.drawtime},Hintsbar.prototype.guessCb=function(e){e.result&&(this.$hintDisplay.html(e.word),this.$container.addClass("guessed-r"))},Hintsbar.prototype.setTimer=function(e){var t=e;this.timerInterval&&clearInterval(this.timerInterval),this.$timerDisplay.html(t),this.timerInterval=setInterval(function(e){--t,e.$timerDisplay.html(t),0>=t&&clearInterval(e.timerInterval)},1e3,this)},Hintsbar.prototype.newRound=function(){this.round++,this.$roundDisplay.html(this.round)},Hintsbar.prototype.displayDrawer=function(e){this.$hintDisplay.html(e.username+" is choosing a word !")},Hintsbar.prototype.turnStart=function(e){this.$container.removeClass("guessed-r"),this.$hintDisplay.html(e.name),this.$timerDisplay.html(this.turntime),this.$wordTypeDisplay.html(e.wordtype),this.setTimer(this.turntime)},Hintsbar.prototype.endTurn=function(e,t=null){this.$hintDisplay.html(e);var a=t?t:constant_data.END_TURN_TIME;console.log(a),this.setTimer(a)};var hintsbar=new Hintsbar;function Scoreboard(){this.$container=$("#Scoreboard"),this.$modal=$("#sc-modal"),this.modalContainer=".lobby-container",this.modalSel={$top1:$("#top_1"),$top2:$("#top_2"),$top3:$("#top_3"),top4:"top_4",$lh:$("#sc-fh"),$rh:$("#sc-sh")},this.guesserClass="guessed-r",this.drawerID=-1,this.scores={},socket.addObserver(constant_data.MSG_TYPES.CREATE_ROOM,(...e)=>this.createRoomCb.call(this,...e)),socket.addObserver(constant_data.MSG_TYPES.JOIN_ROOM,(...e)=>this.joinRoomCb.call(this,...e)),socket.addObserver(constant_data.MSG_TYPES.START_GAME,(...e)=>this.resetData.call(this)),socket.addObserver(constant_data.MSG_TYPES.ADD_PLAYER,(...e)=>this.addPlayerCb.call(this,...e)),socket.addObserver(constant_data.MSG_TYPES.REMOVE_PLAYER,(...e)=>this.removePlayer.call(this,...e)),socket.addObserver(constant_data.MSG_TYPES.REMOVE_PLAYERS,(...e)=>this.removeMultiplePlayers.call(this,...e)),socket.addObserver(constant_data.MSG_TYPES.PLAYER_DISCONNECTED,(...e)=>this.setDisconnected.call(this,...e)),socket.addObserver(constant_data.MSG_TYPES.PLAYER_RECONNECTED,(...e)=>this.setReconnected.call(this,...e)),socket.addObserver(constant_data.MSG_TYPES.NEW_OWNER,(...e)=>this.setOwner.call(this,...e)),socket.addObserver(constant_data.MSG_TYPES.NEW_DRAWER,e=>this.newDrawerCb.call(this,e.accountid)),socket.addObserver(constant_data.MSG_TYPES.P_GUESSED_T,(...e)=>this.addGuesser.call(this,...e)),socket.addObserver(constant_data.MSG_TYPES.WORDS_CHOICE,()=>this.newDrawerCb.call(this,userData.accountid)),socket.addObserver(constant_data.MSG_TYPES.END_TURN,(...e)=>this.endTurnCb.call(this,...e)),socket.addObserver(constant_data.MSG_TYPES.END_GAME,(...e)=>this.endGameCb.call(this,...e)),socket.addObserver(constant_data.MSG_TYPES.BACK_TO_LOBBY,(...e)=>this.disableModal.call(this,...e))}Scoreboard.prototype.createRoomCb=function(e){this.$container.empty(),this.addPlayer(userData.description(),e)},Scoreboard.prototype.resetData=function(){for(const e in this.scores)this.scores[e]=0;this.$container.find(".ps-score").html(0),this.$container.find(".ps-rank").html(1)},Scoreboard.prototype.joinRoomCb=function(e,t,a=null){this.scores={},this.$container.empty();for(const[o,n]of Object.entries(t))this.addPlayer(n,e,a)},Scoreboard.prototype.newDrawerCb=function(e){null!==this.drawerID&&this.$container.find("#ps-"+this.drawerID).find(".ps-drawing").remove(),this.drawerID=e,this.$container.find("#ps-"+this.drawerID).append($("<img src=\"https://cdn.inkdove.com/images/drawing.png\" class=\"ps-drawing\" data-toggle=\"tooltip\" data-placement=\"top\" title=\"Drawer\"/>")),this.resetGuessers()},Scoreboard.prototype.endTurnCb=function(e){let t=e.lastguesser,a=e.drawerScore;t&&this.addGuesser(t),this.addGuesser({accountid:this.drawerID,score:a}),this.reorder()},Scoreboard.prototype.reorder=function(){var e=this.scores;let t=this.$container;t.children().detach().sort(function(t,a){var o=e[t.id.substring(3,t.id.length)],n=e[a.id.substring(3,a.id.length)];return console.log(o+" and "+n),o<n?1:o>n?-1:0}).each((e,t)=>{$(t).find(".ps-rank").html(e+1)}).appendTo(t)},Scoreboard.prototype.addGuesser=function(e){this.scores[e.accountid]+=e.score;var t=this.$container.find("#ps-"+e.accountid);t.addClass(this.guesserClass),t.find(".ps-score").html(this.scores[e.accountid])},Scoreboard.prototype.resetGuessers=function(){this.$container.find("."+this.guesserClass).removeClass(this.guesserClass)},Scoreboard.prototype.addPlayerCb=function(e){this.addPlayer(e,room.mainData,room.ingameData)},Scoreboard.prototype.removeMultiplePlayers=function(e){for(var t=0;t<e.length;t++)this.removePlayer(e[t])},Scoreboard.prototype.removePlayer=function(e){var t=e.accountid,a=e.owner;this.$container.find("#ps-"+t).remove(),null!==a&&this.$container.find("#ps-"+a).append($("<img src=\"https://cdn.inkdove.com/images/crown.png\" class=\"ps-owner owner\"/>"))},Scoreboard.prototype.setOwner=function(e){this.$container.find(".owner").remove(),this.$container.find("#ps-"+e).append($("<img src=\"https://cdn.inkdove.com/images/crown.png\" class=\"ps-owner owner\"/>"))},Scoreboard.prototype.setDrawer=function(e){this.$container.find(".ps-drawing").remove(),this.$container.find("#ps-"+e).append($("<img src=\"https://cdn.inkdove.com/images/drawing.png\" class=\"ps-drawing\" data-toggle=\"tooltip\" data-placement=\"top\" title=\"Drawer\"/>"))},Scoreboard.prototype.setDisconnected=function(e){this.$container.find("#ps-"+e).addClass("disconnected")},Scoreboard.prototype.setReconnected=function(e){this.$container.find("#ps-"+e).removeClass("disconnected")},Scoreboard.prototype.addPlayer=function(e,t,a=null){var o=e.accountid,n=e.username,s=e.score;this.scores[o]=s;var r=$("<div></div>").addClass("player-score-ingame").attr("id","ps-"+o);t.owner==o&&r.append($("<img src=\"https://cdn.inkdove.com/images/crown.png\" class=\"ps-owner owner\"/>")),a&&a.ing_drawer==o&&r.append($("<img src=\"https://cdn.inkdove.com/images/drawing.png\" class=\"ps-drawing\" data-toggle=\"tooltip\" data-placement=\"top\" title=\"Drawer\"/>")),e.hasOwnProperty("guessed")&&e.guessed&&r.addClass(this.guesserClass);var i=$("<div class=\"ps-rank\"></div>").html("1"),l=$("<div class=\"ps-data\"></div>"),d=$("<div class=\"ps-uname\"></div>").html(n),c=$("<div class=\"ps-score\"></div>").html(s);l.append(d),l.append(c),r.append(i),r.append(l),this.$container.append(r)},Scoreboard.prototype.endGameCb=function(){var e=this.scores,t=Object.keys(e).sort(function(t,a){return e[a]-e[t]});this.setupModal(t),this.displayModal()},Scoreboard.prototype.setupModal=function(e){this.modalSel.$lh.empty(),this.modalSel.$rh.empty(),console.log(e),this.modalSel.$top1.html("1 "+room.players[e.shift()]),this.modalSel.$top2.html("2 "+room.players[e.shift()]);var t=0<e.length?e.shift():"no one";this.modalSel.$top3.html("3 "+room.players[t]);for(var a=Math.ceil(e.length/2),o=0;0<e.length;){var n=$("<div class=\"top_4\"></div>").html(o+4+" "+room.players[e.shift()]);o<a?this.modalSel.$lh.append(n):this.modalSel.$rh.append(n),o++}},Scoreboard.prototype.displayModal=function(){this.$modal.modal("show"),$(".modal-backdrop").appendTo(this.modalContainer),$("body").removeClass(),$("body").css("padding-right","")},Scoreboard.prototype.disableModal=function(){this.$modal.modal("hide")};var scoreboard=new Scoreboard;function SoundHandler(){this.$volume=$("#volume"),this.volume=0,this.correctSound=new Audio("https://cdn.inkdove.com/sound/correct.mp3"),this.DrawingSound=new Audio("https://cdn.inkdove.com/sound/drawing.wav"),socket.addObserver(constant_data.MSG_TYPES.GUESS,(...e)=>this.guessCb.call(this,...e)),socket.addObserver(constant_data.MSG_TYPES.P_GUESSED_T,(...e)=>this.otherGuesserCb.call(this,...e)),socket.addObserver(constant_data.MSG_TYPES.START_DRAW,(...e)=>this.playStartDrawingSound.call(this,...e)),socket.addObserver(constant_data.MSG_TYPES.START_DRAW_D,(...e)=>this.playStartDrawingSound.call(this,...e))}SoundHandler.prototype.guessCb=function(e){e.result&&this.playGuessedSound()},SoundHandler.prototype.otherGuesserCb=function(e){e.accountid===userData.accountid||this.playGuessedSound()},SoundHandler.prototype.playGuessedSound=function(){this.correctSound.volume=this.$volume.val()/100,this.correctSound.play()},SoundHandler.prototype.playStartDrawingSound=function(){this.DrawingSound.volume=this.$volume.val()/100,this.DrawingSound.play()};var soundHandler=new SoundHandler;function TopBar(){this.$lobby=$("#tb-l"),this.$ingame=$("#tb-ig"),this.$ownerBtns=$(".ownerButtons"),this.$startBtn=$("#startgame-but"),this.$leaveRoomBtn=$("#leave-room-but"),this.$backToLobbyBtn=$("#endgame_but"),this.canClick=!0,this.$startBtn.click(()=>this.startGame.call(this)),this.$leaveRoomBtn.click(()=>{sceneTransitioner.goToRoomBrowser.call(sceneTransitioner),socket.emit(constant_data.MSG_TYPES.LEAVE_ROOM,!0)}),this.$backToLobbyBtn.click(()=>this.sendBackToLobby()),socket.addObserver(constant_data.MSG_TYPES.CREATE_ROOM,(...e)=>this.createGamecb.call(this,...e)),socket.addObserver(constant_data.MSG_TYPES.JOIN_ROOM,(...e)=>this.joinRoomcb.call(this,...e)),socket.addObserver(constant_data.MSG_TYPES.REMOVE_PLAYER,e=>this.newOwnerCb.call(this,e.owner)),socket.addObserver(constant_data.MSG_TYPES.NEW_OWNER,(...e)=>this.newOwnerCb.call(this,...e)),socket.addObserver(constant_data.MSG_TYPES.START_GAME,(...e)=>this.goIngame.call(this,...e)),socket.addObserver(constant_data.MSG_TYPES.END_GAME,()=>{this.canClick=!1}),socket.addObserver(constant_data.MSG_TYPES.BACK_TO_LOBBY,()=>this.goToLobby.call(this))}TopBar.prototype.createGamecb=function(){this.goToLobby(),this.enableOwner()},TopBar.prototype.joinRoomcb=function(e){this.disableOwner(),e.ingame?this.goIngame():this.goToLobby()},TopBar.prototype.startGame=function(){room.ownerIsPlayer()&&socket.emit(constant_data.MSG_TYPES.START_GAME,!0)},TopBar.prototype.newOwnerCb=function(e){null===e||(userData.isPlayer(e)?this.enableOwner():this.disableOwner())},TopBar.prototype.enableOwner=function(){this.$ownerBtns.show()},TopBar.prototype.disableOwner=function(){this.$ownerBtns.hide()},TopBar.prototype.goToLobby=function(){this.canClick=!0,this.$ingame.hide(),this.$lobby.show()},TopBar.prototype.goIngame=function(){this.$lobby.hide(),this.$ingame.show()},TopBar.prototype.sendBackToLobby=function(){room.ownerIsPlayer&&(socket.emit(constant_data.MSG_TYPES.BACK_TO_LOBBY,!1),this.$backToLobbyBtn.prop("disabled",!0))};var topBar=new TopBar;function WordChoice(){this.$modal=$("#wg-modal"),this.$container=$("#wg-mod-cont"),this.$timer=$("#timer-cw"),this.modalContainer=".lobby-container",this.wordsClass=".c-word",this.interval=null,this.$container.on("click",this.wordsClass,t=>{this.clearTimer(),this.close();var e=t.target.id.substring(2,t.target.id.length);socket.emit(constant_data.MSG_TYPES.WORDS_CHOICE,!1,e)}),socket.addObserver(constant_data.MSG_TYPES.WORDS_CHOICE,(...e)=>this.display.call(this,...e)),socket.addObserver(constant_data.MSG_TYPES.START_DRAW_D,(...e)=>this.close.call(this,...e))}WordChoice.prototype.display=function(e){this.$container.empty();for(const[t,a]of Object.entries(e))this.addWord(a);this.open(),this.setTimer()},WordChoice.prototype.setTimer=function(){var e=constant_data.FORCE_WORD_TIMER;this.clearTimer(),this.interval=setInterval(function(t){--e,t.$timer.html(e),0>=e&&(t.close(),t.clearTimer())},1e3,this)},WordChoice.prototype.clearTimer=function(){this.interval&&(clearInterval(this.interval),this.interval=null)},WordChoice.prototype.addWord=function(e){var t="wg"+e.id,a=$("<button>",{type:"button",class:"btn btn-light c-word",id:t}).html(e.name);this.$container.append(a)},WordChoice.prototype.open=function(){this.$modal.modal("show"),$(".modal-backdrop").appendTo(this.modalContainer),$("body").removeClass(),$("body").css("padding-right","")},WordChoice.prototype.close=function(){this.$modal.modal("hide")};var wordChoice=new WordChoice;(function(e,t,a){e(function(){e("[data-toggle=\"tooltip\"]").tooltip(),e(a).unbind("keydown").bind("keydown",function(t){if(8===t.keyCode){var a=!0,o=e(t.srcElement||t.target),n=o.prop("readonly")||o.prop("disabled");if(!n)if(o[0].isContentEditable)a=!1;else if(o.is("input")){var s=o.attr("type");s&&(s=s.toLowerCase()),-1<["text","password","file","search","email","number","date","color","datetime","datetime-local","month","range","search","tel","time","url","week"].indexOf(s)&&(a=!1)}else o.is("textarea")&&(a=!1);if(a)return t.preventDefault(),!1}}),socket.setup()})})(window.jQuery,window,document);