const constant_data=Object.freeze({MAX_PLAYERS:10,MIN_USERNAME_LENGTH:2,MAX_USERNAME_LENGTH:12,MIN_PASSWORD_LENGTH:4,MAX_PASSWORD_LENGTH:60,MAX_MESSAGE_LENGTH:40,MAX_ROOM_LENGTH:16,MIN_ROOMNAME_LENGTH:2,MIN_ROUNDS:2,MAX_ROUNDS:10,FORCE_WORD_TIMER:20,END_TURN_TIME:6,BTL_VOTE_DURATION:15,DRAW_TIME_VALUES:[30,60,80,160],ROUNDS_VALUES:[2,3,4,5,6,7,8,9,10],LANG_VALUES:["en","fr"],MAP_SIZE:3e3,VALUE_RANGES:{},DEFAULT_Values:{ROUNDS:8,DRAWTIME:80,LANG_CHECK:!0,LANG:"en"},MSG_TYPES:{LOGIN:"log",SPAM_ALERT:"spal",USER_DATA:"ud",ALREADY_LOGGED:"alog",DISCONNECTED:"disc",REGISTER:"reg",BROWSER_UPDATE:"rbu",ROOM_DOES_NOT_EXIST:"rdne",ERROR:"err",CREATE_ROOM:"crro",JOIN_ROOM:"joro",UPDATE_ANIME_LIST:"upali",ADD_PLAYER:"adpl",REMOVE_PLAYER:"repl",REMOVE_PLAYERS:"repls",NEW_OWNER:"neow",LEAVE_ROOM:"Lero",START_GAME:"stga",UPDATE_ROOM:"upro",RECONNECT_ROOM:"rero",PLAYER_RECONNECTED:"plre",PLAYER_DISCONNECTED:"plds",MESSAGE:"msg",NEW_DRAWER:"drw",NEW_ROUND:"newrund",P_DC:"pdc",GUESS:"guess",P_GUESSED_T:"pguet",WORDS_CHOICE:"worchoi",START_DRAW:"stdr",DRAW_CLEAR:"drcl",START_DRAW_D:"stdrd",END_TURN:"entu",END_GAME:"enga",BACK_TO_LOBBY:"batol",BACK_TO_LOBBY_VOTE:"batolv",END_BTL_VOTE:"ebtlv",DRAW:"draw",GET_ANIME_NAMES:"geann"},RESULT:{SUCCESS:"success",FAILURE:"failure"},ANIMELISTS:{MAL:0,ANILIST:1}}),roomStates=Object.freeze({STARTING_GAME:0,PICKING_WORD:1,DRAWING:2,ENDING_TURN:3,ENDING_GAME:4});try{module.exports.constant_data=constant_data,module.exports.roomStates=roomStates,module.exports.RoomData=RoomData}catch(a){}function InputCheck(a,b){a?(b.removeClass("is-invalid"),b.addClass("is-valid")):(b.removeClass("is-valid"),b.addClass("is-invalid"))}function LoadingAnimation(){this.$spinner=$("#loading-log")}LoadingAnimation.prototype.enable=function(a){a.prop("disabled",!0),this.$spinner.show()},LoadingAnimation.prototype.disable=function(a){a.prop("disabled",!1),this.$spinner.hide()};var loadingAnimation=new LoadingAnimation;function SceneTransitioner(){this.$loginForm=$("#login-p"),this.$registerForm=$("#register-p"),this.$resetPasswordView=$("#Reset-p"),this.$typeNewPasswordView=$("#Typenewp-p"),this.$forgotpwdbtn=$("#repwdreqbtn"),this.$cancelRegButton=$("#cancel-but"),this.$CreateAccButton=$("#createacc-but"),this.$cencelresetpwd=$("#cancel-resetpwd-but"),this.$activeScene=this.$loginForm,this.$cancelRegButton.click(()=>this.transition(this.$loginForm)),this.$cencelresetpwd.click(()=>this.transition(this.$loginForm)),this.$CreateAccButton.click(()=>this.transition(this.$registerForm)),this.$forgotpwdbtn.click(()=>this.transition(this.$resetPasswordView))}SceneTransitioner.prototype.GoToLogin=function(){this.transition(this.$loginForm)},SceneTransitioner.prototype.GoToNewPwd=function(){this.transition(this.$typeNewPasswordView)},SceneTransitioner.prototype.transition=function(a){this.$activeScene.hide(),a.show(),this.$activeScene=a};var sceneTransitioner=new SceneTransitioner;function Register(){this.$username=$("#RusernameInp"),this.$password=$("#RPassInp"),this.$r_password=$("#RRpassInp"),this.$email=$("#RmailInp"),this.$inputs=$(".regInp"),this.$registerButton=$("#register-but"),this.errorSelectors={$username:$("#reg-user"),$password:$("#reg-pass"),$email:$("#reg-mail")},this.$registerButton.click(()=>this.sendRegister()),this.$inputs.keydown(function(a){13==a.keyCode&&this.sendRegister()})}Register.prototype.sendRegister=function(){loadingAnimation.enable(this.$inputs);let a=this.$username.val(),b=this.$email.val(),c=this.$password.val(),d=this.$r_password.val();var e={u:!0,p:!0,rp:!0,v:!0};if((a.length>constant_data.MAX_USERNAME_LENGTH||a.length<constant_data.MIN_USERNAME_LENGTH)&&(e.u=!1,e.v=!1),(c.length<constant_data.MIN_PASSWORD_LENGTH||c.length>constant_data.MAX_PASSWORD_LENGTH)&&(e.p=!1,e.v=!1),c!==d&&(e.rp=!1,e.v=!1),!1==e.v)return loadingAnimation.disable(this.$inputs),this.RegisterInputFeedback(e);var f=this;return $.ajax({type:"POST",url:"register",data:JSON.stringify({username:a,password:c,email:b}),contentType:"application/json",success:function(){Swal.fire({icon:"success",text:"you have been registered successfully. You can now login"}),loadingAnimation.disable(f.$inputs),sceneTransitioner.GoToLogin()},error:function(a,b,c){loadingAnimation.disable(f.$inputs),f.RegisterFailureFeedback(c)}})},Register.prototype.RegisterFailureFeedback=function(a){this.SetOnListenRegisterFeedback();var b=a.split("");if(!(1>b.length))for(var c=0;c<b.length;c++)"u"==b[c]?InputCheck(!1,this.$username):"p"==b[c]?InputCheck(!1,this.$password):"e"==b[c]&&InputCheck(!1,this.$email)},Register.prototype.RegisterInputFeedback=function(a){this.SetLocalRegisterFeedback(),InputCheck(a.u,this.$username),InputCheck(a.p,this.$password),InputCheck(a.rp,this.$r_password)},Register.prototype.SetOnListenRegisterFeedback=function(){this.errorSelectors.$email.text("Email is already used"),this.errorSelectors.$password.text("Invalid password error"),this.errorSelectors.$username.text("Username is already used")},Register.prototype.SetLocalRegisterFeedback=function(){this.errorSelectors.$email.text("please type a correct mail"),this.errorSelectors.$password.text("please type a password longer than "+constant_data.MIN_PASSWORD_LENGTH),this.errorSelectors.$username.text("please type a username shorter than "+constant_data.MAX_USERNAME_LENGTH+" characters and longer than "+constant_data.MIN_USERNAME_LENGTH)};var register=new Register;function ResetPwd(){this.$emailInp=$("#resetpwd-mail-inp"),this.$sendbtn=$("#sendresetpwd-but"),this.$inputs=$(".resetInp"),this.$sendbtn.click(()=>this.send()),this.$emailInp.keydown(a=>{13==a.keyCode&&this.send()})}ResetPwd.prototype.send=function(){loadingAnimation.enable(this.$inputs);let a=this.$emailInp.val();const b=this;$.ajax({type:"POST",url:"resetpwd",data:JSON.stringify({email:a}),contentType:"application/json",success:function(){Swal.fire({icon:"success",text:"Your request has been succesfully sent. If the email you provided is correct, you should receive and email with the instructions to reset Your password in a few minutes"}),loadingAnimation.disable(b.$inputs),sceneTransitioner.GoToLogin()},error:function(a){Swal.fire({icon:"error",text:a.responseText}),loadingAnimation.disable(b.$inputs)}})};var resetpwd=new ResetPwd;function Login(){this.$username=$("#username-input"),this.$password=$("#password-input"),this.$inputs=$(".logInp"),this.$loginBtn=$("#login-but"),this.$loginBtn.click(()=>this.sendLogin()),this.$inputs.keydown(a=>{13==a.keyCode&&this.sendLogin()}),window.cookieconsent.initialise({palette:{popup:{background:"#17252A"},button:{background:"#2B7A78"}},theme:"classic",content:{message:"Inkdove uses cookies to help improve user experience. By continuing to use this website you agree to allow Inkdove to use cookies.",href:"www.inkdove.com/privacy"}})}Login.prototype.sendLogin=function(){loadingAnimation.enable(this.$inputs);var a={u:!0,p:!0,v:!0};let b=this.$username.val(),c=this.$password.val();if((b.length>constant_data.MAX_USERNAME_LENGTH||b.length<constant_data.MIN_USERNAME_LENGTH)&&(a.u=!1,a.v=!1),(c.length<constant_data.MIN_PASSWORD_LENGTH||c.length>constant_data.MAX_PASSWORD_LENGTH)&&(a.p=!1,a.v=!1),!1==a.v)return loadingAnimation.disable(this.$inputs),this.InputFeedback(a);var d=this;$.ajax({type:"POST",url:"login",data:JSON.stringify({username:b,password:c}),contentType:"application/json",success:function(){location.reload()},error:function(a,b,c){loadingAnimation.disable(d.$inputs),d.FailureFeedback(c)}})},Login.prototype.FailureFeedback=function(){Swal.fire({icon:"error",text:"Incorrect credentials. Could not login"})},Login.prototype.InputFeedback=function(a){InputCheck(a.u,this.$username),InputCheck(a.p,this.$password)};var login=new Login;function NewPassword(){this.$password=$("#reset-password-input"),this.$rPassword=$("#reset-Rpassword-input"),this.$sendbtn=$("#sendnp-but"),this.$inputs=$(".newpInp"),this.id=-1,this.token="",this.$sendbtn.click(()=>this.send()),this.parseQuery()}NewPassword.prototype.parseQuery=function(){const a=new URLSearchParams(window.location.search);a.has("token")&&a.has("id")&&(this.token=a.get("token"),this.id=a.get("id"),sceneTransitioner.GoToNewPwd())},NewPassword.prototype.send=function(){if(-1===this.id)return Swal.fire({icon:"error",text:"Unauthorized request, please reload this page"});loadingAnimation.enable(this.$inputs);let a=this.$password.val(),b=this.$rPassword.val();var c={p:!0,rp:!0};if(a!==b&&(c.rp=!1),(a.length<constant_data.MIN_PASSWORD_LENGTH||a.length>constant_data.MAX_PASSWORD_LENGTH)&&(c.p=!1),!c.p||!c.rp)return this.InputFeedback(c);const d=this;return $.ajax({type:"POST",url:"newpwd",data:JSON.stringify({id:d.id,token:d.token,password:a}),contentType:"application/json",success:function(){loadingAnimation.disable(d.$inputs),sceneTransitioner.GoToLogin(),Swal.fire({icon:"success",text:"Your password has been succesfully changed",showCancelButton:!1,allowOutsideClick:!1,confirmButtonText:"Go to login"}).then(a=>{a.isConfirmed&&window.location.assign(window.location.origin)})},error:function(a){loadingAnimation.disable(d.$inputs),Swal.fire({icon:"error",text:a.responseText})}})},NewPassword.prototype.InputFeedback=function(a){InputCheck(a.p,this.$password),InputCheck(a.rp,this.$rPassword)};var newPassword=new NewPassword;